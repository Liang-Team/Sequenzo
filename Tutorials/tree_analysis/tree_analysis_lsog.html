<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sequenzo Tutorial">
<meta name="dcterms.date" content="2026-02-10">

<title>Tree Analysis Tutorial: Understanding Sequence Patterns with Regression Trees</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="tree_analysis_lsog_files/libs/clipboard/clipboard.min.js"></script>
<script src="tree_analysis_lsog_files/libs/quarto-html/quarto.js"></script>
<script src="tree_analysis_lsog_files/libs/quarto-html/popper.min.js"></script>
<script src="tree_analysis_lsog_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="tree_analysis_lsog_files/libs/quarto-html/anchor.min.js"></script>
<link href="tree_analysis_lsog_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="tree_analysis_lsog_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="tree_analysis_lsog_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="tree_analysis_lsog_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="tree_analysis_lsog_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#what-youll-learn" id="toc-what-youll-learn" class="nav-link" data-scroll-target="#what-youll-learn">What You‚Äôll Learn</a></li>
  <li><a href="#dataset-lsog-dyadic-children" id="toc-dataset-lsog-dyadic-children" class="nav-link" data-scroll-target="#dataset-lsog-dyadic-children">Dataset: LSOG Dyadic Children</a></li>
  <li><a href="#prerequisites" id="toc-prerequisites" class="nav-link" data-scroll-target="#prerequisites">Prerequisites</a></li>
  </ul></li>
  <li><a href="#setup-and-data-loading" id="toc-setup-and-data-loading" class="nav-link" data-scroll-target="#setup-and-data-loading">Setup and Data Loading</a></li>
  <li><a href="#basic-utility-functions" id="toc-basic-utility-functions" class="nav-link" data-scroll-target="#basic-utility-functions">Basic Utility Functions</a>
  <ul class="collapse">
  <li><a href="#compute-pseudo-variance-dissvar" id="toc-compute-pseudo-variance-dissvar" class="nav-link" data-scroll-target="#compute-pseudo-variance-dissvar">Compute Pseudo-Variance (<code>dissvar</code>)</a></li>
  <li><a href="#compute-distance-association-dissassoc" id="toc-compute-distance-association-dissassoc" class="nav-link" data-scroll-target="#compute-distance-association-dissassoc">Compute Distance Association (<code>dissassoc</code>)</a></li>
  </ul></li>
  <li><a href="#building-regression-trees" id="toc-building-regression-trees" class="nav-link" data-scroll-target="#building-regression-trees">Building Regression Trees</a>
  <ul class="collapse">
  <li><a href="#build-distance-tree-disstree" id="toc-build-distance-tree-disstree" class="nav-link" data-scroll-target="#build-distance-tree-disstree">Build Distance Tree (<code>disstree</code>)</a></li>
  <li><a href="#build-sequence-tree-seqtree" id="toc-build-sequence-tree-seqtree" class="nav-link" data-scroll-target="#build-sequence-tree-seqtree">Build Sequence Tree (<code>seqtree</code>)</a></li>
  </ul></li>
  <li><a href="#extracting-information-from-trees" id="toc-extracting-information-from-trees" class="nav-link" data-scroll-target="#extracting-information-from-trees">Extracting Information from Trees</a>
  <ul class="collapse">
  <li><a href="#get-leaf-membership-disstreeleaf" id="toc-get-leaf-membership-disstreeleaf" class="nav-link" data-scroll-target="#get-leaf-membership-disstreeleaf">Get Leaf Membership (<code>disstreeleaf</code>)</a></li>
  <li><a href="#get-classification-rules-disstree.get.rules" id="toc-get-classification-rules-disstree.get.rules" class="nav-link" data-scroll-target="#get-classification-rules-disstree.get.rules">Get Classification Rules (<code>disstree.get.rules</code>)</a></li>
  <li><a href="#assign-to-leaves-disstree.assign" id="toc-assign-to-leaves-disstree.assign" class="nav-link" data-scroll-target="#assign-to-leaves-disstree.assign">Assign to Leaves (<code>disstree.assign</code>)</a></li>
  </ul></li>
  <li><a href="#visualizing-trees" id="toc-visualizing-trees" class="nav-link" data-scroll-target="#visualizing-trees">Visualizing Trees</a>
  <ul class="collapse">
  <li><a href="#print-tree-print.disstree" id="toc-print-tree-print.disstree" class="nav-link" data-scroll-target="#print-tree-print.disstree">Print Tree (<code>print.disstree</code>)</a></li>
  <li><a href="#plot-tree-seqtreedisplay-disstreedisplay" id="toc-plot-tree-seqtreedisplay-disstreedisplay" class="nav-link" data-scroll-target="#plot-tree-seqtreedisplay-disstreedisplay">Plot Tree (<code>seqtreedisplay</code> / <code>disstreedisplay</code>)</a></li>
  <li><a href="#export-to-dot-disstree2dot-seqtree2dot" id="toc-export-to-dot-disstree2dot-seqtree2dot" class="nav-link" data-scroll-target="#export-to-dot-disstree2dot-seqtree2dot">Export to DOT (<code>disstree2dot</code> / <code>seqtree2dot</code>)</a></li>
  </ul></li>
  <li><a href="#complete-workflow-example" id="toc-complete-workflow-example" class="nav-link" data-scroll-target="#complete-workflow-example">Complete Workflow Example</a></li>
  <li><a href="#summary-and-next-steps" id="toc-summary-and-next-steps" class="nav-link" data-scroll-target="#summary-and-next-steps">Summary and Next Steps</a>
  <ul class="collapse">
  <li><a href="#key-takeaways" id="toc-key-takeaways" class="nav-link" data-scroll-target="#key-takeaways">Key Takeaways</a></li>
  <li><a href="#whats-next" id="toc-whats-next" class="nav-link" data-scroll-target="#whats-next">What‚Äôs Next?</a></li>
  <li><a href="#further-reading" id="toc-further-reading" class="nav-link" data-scroll-target="#further-reading">Further Reading</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="tree_analysis_lsog.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Tree Analysis Tutorial: Understanding Sequence Patterns with Regression Trees</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Step-by-step guide using LSOG dyadic_children dataset - TraMineR (R) Implementation</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sequenzo Tutorial </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 10, 2026</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Welcome to the <strong>Tree Analysis</strong> tutorial using <strong>TraMineR (R)</strong>! üå≥</p>
<p>This tutorial demonstrates how to use <strong>regression trees</strong> in TraMineR to understand how different factors (like age, gender, education) explain differences in sequence patterns. This R-based tutorial corresponds to the Python Sequenzo implementation.</p>
<section id="what-youll-learn" class="level2">
<h2 class="anchored" data-anchor-id="what-youll-learn">What You‚Äôll Learn</h2>
<p>By the end of this tutorial, you‚Äôll know how to use TraMineR to:</p>
<ol type="1">
<li><strong>Compute basic statistics</strong> - Calculate variance (<code>dissvar</code>) and test associations (<code>dissassoc</code>)</li>
<li><strong>Build trees</strong> - Create regression trees (<code>disstree</code>, <code>seqtree</code>)</li>
<li><strong>Extract insights</strong> - Get classification rules (<code>disstree.get.rules</code>) and assign sequences (<code>disstree.assign</code>)</li>
<li><strong>Visualize results</strong> - Plot and print trees</li>
</ol>
</section>
<section id="dataset-lsog-dyadic-children" class="level2">
<h2 class="anchored" data-anchor-id="dataset-lsog-dyadic-children">Dataset: LSOG Dyadic Children</h2>
<p>We‚Äôll use the <strong>dyadic_children</strong> dataset from the LSOG (Life Stories of Generations) study. This dataset contains sequences showing how children‚Äôs living arrangements change from age 15 to 39. States represent different living situations (e.g., living with parents, alone, with partner).</p>
</section>
<section id="prerequisites" class="level2">
<h2 class="anchored" data-anchor-id="prerequisites">Prerequisites</h2>
<ul>
<li>Basic R knowledge</li>
<li>TraMineR package installed</li>
<li>Familiarity with sequence data</li>
</ul>
<p>Let‚Äôs get started! üöÄ</p>
</section>
</section>
<section id="setup-and-data-loading" class="level1">
<h1>Setup and Data Loading</h1>
<p>First, let‚Äôs load the necessary R libraries and our data.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load TraMineR library</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(TraMineR)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Define project root path (relative to this file location)</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>project_root <span class="ot">&lt;-</span> <span class="fu">normalizePath</span>(<span class="st">"../../"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>data_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(project_root, <span class="st">"sequenzo/datasets/dyadic_children.csv"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"‚úÖ TraMineR loaded successfully!</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>‚úÖ TraMineR loaded successfully!</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"TraMineR version:"</span>, <span class="fu">as.character</span>(<span class="fu">packageVersion</span>(<span class="st">"TraMineR"</span>)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>TraMineR version: 2.2.10 </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Project root:"</span>, project_root, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Project root: /Users/lei/Documents/Sequenzo_all_folders/Sequenzo </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Data path:"</span>, data_path, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data path: /Users/lei/Documents/Sequenzo_all_folders/Sequenzo/sequenzo/datasets/dyadic_children.csv </code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the dyadic_children dataset</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Use check.names=FALSE to preserve numeric column names (15, 16, etc.)</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Use absolute path relative to project root</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(data_path, </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>, </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">check.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># For this tutorial, we'll use the first 60 rows for faster computation</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df[<span class="dv">1</span><span class="sc">:</span><span class="dv">60</span>, ]</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Dataset loaded:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Dataset loaded:</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Rows:"</span>, <span class="fu">nrow</span>(df), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Rows: 60 </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Columns:"</span>, <span class="fu">ncol</span>(df), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Columns: 27 </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">First few rows:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
First few rows:</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df[, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  dyadID sex 15 16 17 18 19 20 21 22
1     16   1  1  1  1  1  1  3  3  4
2     19   1  1  1  1  1  1  1  1  1
3     26   1  1  1  1  1  2  3  3  3
4     29   0  1  1  1  1  1  1  1  1
5     31   0  1  1  1  2  3  3  3  3
6     43   1  1  1  1  1  1  2  6  6</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract time columns (ages 15-39)</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Columns that are pure numbers (like "15", "16", etc.)</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>time_cols <span class="ot">&lt;-</span> <span class="fu">names</span>(df)[<span class="fu">sapply</span>(<span class="fu">names</span>(df), <span class="cf">function</span>(x) {</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove "X" prefix if present (R adds this for numeric column names)</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    clean_x <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">"^X"</span>, <span class="st">""</span>, x)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if column name is a pure number</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    num_val <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">as.numeric</span>(clean_x))</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(num_val) <span class="sc">&amp;&amp;</span> clean_x <span class="sc">!=</span> <span class="st">""</span> <span class="sc">&amp;&amp;</span> x <span class="sc">!=</span> <span class="st">"dyadID"</span> <span class="sc">&amp;&amp;</span> x <span class="sc">!=</span> <span class="st">"sex"</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>})]</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract numeric values and sort</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>time_nums <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.numeric</span>(<span class="fu">sub</span>(<span class="st">"^X"</span>, <span class="st">""</span>, time_cols)))</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>time_cols <span class="ot">&lt;-</span> <span class="fu">as.character</span>(time_nums)  <span class="co"># Use clean numeric names</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="co"># If R added "X" prefix, use those column names</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">paste0</span>(<span class="st">"X"</span>, time_cols) <span class="sc">%in%</span> <span class="fu">names</span>(df))) {</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    time_cols <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"X"</span>, time_cols)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Found %d time columns: %s ... %s</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">length</span>(time_cols), time_cols[<span class="dv">1</span>], time_cols[<span class="fu">length</span>(time_cols)]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Found 25 time columns: 15 ... 39</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sequence object using seqdef</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># States are coded as 1-6 (different living arrangements)</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>seqdata <span class="ot">&lt;-</span> <span class="fu">seqdef</span>(df[, time_cols], </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">alphabet =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">states =</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"5"</span>, <span class="st">"6"</span>))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"‚úÖ Sequence object created!</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>‚úÖ Sequence object created!</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Number of sequences:"</span>, <span class="fu">nrow</span>(seqdata), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Number of sequences: 60 </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Sequence length:"</span>, <span class="fu">ncol</span>(seqdata), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Sequence length: 25 </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  States:"</span>, <span class="fu">alphabet</span>(seqdata), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  States: 1 2 3 4 5 6 </code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create predictor variables (covariates)</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># These are the factors we want to test: do they explain differences in sequences?</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>predictors <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">gender =</span> <span class="fu">factor</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"M"</span>, <span class="st">"F"</span>), <span class="at">size =</span> <span class="fu">nrow</span>(df), <span class="at">replace =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_group =</span> <span class="fu">factor</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"young"</span>, <span class="st">"middle"</span>, <span class="st">"old"</span>), <span class="at">size =</span> <span class="fu">nrow</span>(df), <span class="at">replace =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">education =</span> <span class="fu">factor</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"low"</span>, <span class="st">"medium"</span>, <span class="st">"high"</span>), <span class="at">size =</span> <span class="fu">nrow</span>(df), <span class="at">replace =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">income =</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(df)) <span class="sc">*</span> <span class="dv">10000</span> <span class="sc">+</span> <span class="dv">50000</span>  <span class="co"># Continuous variable</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"‚úÖ Predictors created:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>‚úÖ Predictors created:</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(predictors))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  gender age_group education   income
1      M     young       low 51191.61
2      M    middle       low 49749.07
3      M    middle    medium 51080.73
4      M    middle       low 45145.65
5      F    middle       low 44957.83
6      F    middle      high 33389.01</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Predictor types:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Predictor types:</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(predictors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   60 obs. of  4 variables:
 $ gender   : Factor w/ 2 levels "F","M": 2 2 2 2 1 1 1 1 2 1 ...
 $ age_group: Factor w/ 3 levels "middle","old",..: 3 1 1 1 1 1 2 1 3 1 ...
 $ education: Factor w/ 3 levels "high","low","medium": 2 2 3 2 2 1 3 1 3 3 ...
 $ income   : num  51192 49749 51081 45146 44958 ...</code></pre>
</div>
</div>
</section>
<section id="basic-utility-functions" class="level1">
<h1>Basic Utility Functions</h1>
<p>Before building trees, let‚Äôs learn about two fundamental TraMineR functions that help us understand sequence variability and associations.</p>
<section id="compute-pseudo-variance-dissvar" class="level2">
<h2 class="anchored" data-anchor-id="compute-pseudo-variance-dissvar">Compute Pseudo-Variance (<code>dissvar</code>)</h2>
<p><strong>What it does</strong>: Measures how ‚Äúspread out‚Äù sequences are in terms of their distances from each other. Think of it like variance, but for sequences!</p>
<p><strong>When to use</strong>: When you want to know how diverse or similar your sequences are overall.</p>
<p><strong>Corresponds to Sequenzo</strong>: <code>compute_pseudo_variance()</code></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, compute a distance matrix</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This tells us how "different" each pair of sequences is</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"[&gt;] Computing distance matrix using LCS method...</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[&gt;] Computing distance matrix using LCS method...</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>dist_matrix <span class="ot">&lt;-</span> <span class="fu">seqdist</span>(seqdata, <span class="at">method =</span> <span class="st">"LCS"</span>, <span class="at">norm =</span> <span class="st">"auto"</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"‚úÖ Distance matrix computed:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>‚úÖ Distance matrix computed:</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Dimensions:"</span>, <span class="fu">dim</span>(dist_matrix), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Dimensions: 60 60 </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Class:"</span>, <span class="fu">class</span>(dist_matrix), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Class: matrix array </code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute pseudo-variance (unweighted)</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>variance <span class="ot">&lt;-</span> <span class="fu">dissvar</span>(dist_matrix, <span class="at">weights =</span> <span class="cn">NULL</span>, <span class="at">squared =</span> <span class="cn">FALSE</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pseudo-variance (unweighted):"</span>, variance, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Pseudo-variance (unweighted): 0.2784667 </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Interpretation: This value represents the average 'spread' of sequences.</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Interpretation: This value represents the average 'spread' of sequences.</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Higher values = more diverse sequences</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Higher values = more diverse sequences</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Lower values = more similar sequences</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Lower values = more similar sequences</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute pseudo-variance with weights</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This is useful when some sequences are more important than others</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>weights <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fl">2.0</span>, <span class="fu">nrow</span>(seqdata))</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>variance_weighted <span class="ot">&lt;-</span> <span class="fu">dissvar</span>(dist_matrix, <span class="at">weights =</span> weights, <span class="at">squared =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pseudo-variance (weighted, all weights=2):"</span>, variance_weighted, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Pseudo-variance (weighted, all weights=2): 0.2784667 </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Note: With equal weights, weighted variance ‚âà unweighted variance</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Note: With equal weights, weighted variance ‚âà unweighted variance</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute pseudo-variance with squared distances</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Squaring emphasizes larger differences</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>variance_squared <span class="ot">&lt;-</span> <span class="fu">dissvar</span>(dist_matrix, <span class="at">weights =</span> <span class="cn">NULL</span>, <span class="at">squared =</span> <span class="cn">TRUE</span>)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pseudo-variance (squared):"</span>, variance_squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Pseudo-variance (squared): 0.1782222 </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pseudo-variance (normal):"</span>, variance, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Pseudo-variance (normal): 0.2784667 </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Note: Squared variance is typically larger because it emphasizes big differences</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Note: Squared variance is typically larger because it emphasizes big differences</code></pre>
</div>
</div>
</section>
<section id="compute-distance-association-dissassoc" class="level2">
<h2 class="anchored" data-anchor-id="compute-distance-association-dissassoc">Compute Distance Association (<code>dissassoc</code>)</h2>
<p><strong>What it does</strong>: Tests whether a grouping variable (like gender or age group) explains differences in sequence patterns. It‚Äôs like ANOVA, but for sequences!</p>
<p><strong>When to use</strong>: When you want to know if sequences in different groups (e.g., men vs.&nbsp;women) are significantly different.</p>
<p><strong>Corresponds to Sequenzo</strong>: <code>compute_distance_association()</code></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test association between sequences and gender</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This tells us: do men and women have different sequence patterns?</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span> predictors<span class="sc">$</span>gender</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Run dissassoc</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>assoc_result <span class="ot">&lt;-</span> <span class="fu">dissassoc</span>(dist_matrix, groups, </span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">weights =</span> <span class="cn">NULL</span>, </span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">R =</span> <span class="dv">100</span>,  <span class="co"># Number of permutations (smaller for speed)</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">weight.permutation =</span> <span class="st">"none"</span>, </span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">squared =</span> <span class="cn">FALSE</span>)</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Association Test Results ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>=== Association Test Results ===</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pseudo F-statistic:"</span>, assoc_result<span class="sc">$</span>stat[<span class="st">"Pseudo F"</span>, <span class="st">"t0"</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Pseudo F-statistic: 1.432873 </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pseudo R¬≤:"</span>, assoc_result<span class="sc">$</span>stat[<span class="st">"Pseudo R2"</span>, <span class="st">"t0"</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Pseudo R¬≤: 0.0241091 </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"P-value:"</span>, assoc_result<span class="sc">$</span>stat[<span class="st">"Pseudo F"</span>, <span class="st">"p.value"</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>P-value: 0.19 </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Interpretation:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Interpretation:</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Pseudo R¬≤:"</span>, <span class="fu">round</span>(assoc_result<span class="sc">$</span>stat[<span class="st">"Pseudo R2"</span>, <span class="st">"t0"</span>] <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"% of variance explained by gender</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>- Pseudo R¬≤: 2.4 % of variance explained by gender</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- P-value:"</span>, <span class="fu">ifelse</span>(assoc_result<span class="sc">$</span>stat[<span class="st">"Pseudo F"</span>, <span class="st">"p.value"</span>] <span class="sc">&lt;</span> <span class="fl">0.05</span>, </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"Significant"</span>, <span class="st">"Not significant"</span>), <span class="st">"(p &lt; 0.05)</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>- P-value: Not significant (p &lt; 0.05)</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at detailed results</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Statistics Table ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Statistics Table ===</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(assoc_result<span class="sc">$</span>stat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                    t0 p.value
Pseudo F   1.432872978    0.19
Pseudo Fbf 1.478575077    0.18
Pseudo R2  0.024109098    0.19
Bartlett   0.004424744    0.68
Levene     0.152576074    0.75</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Group Information ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Group Information ===</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(assoc_result<span class="sc">$</span>groups)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       n discrepancy
F     33   0.2686869
M     27   0.2755007
Total 60   0.2784667</code></pre>
</div>
</div>
</section>
</section>
<section id="building-regression-trees" class="level1">
<h1>Building Regression Trees</h1>
<p>Now for the exciting part! We‚Äôll build regression trees that automatically find which factors best explain differences in sequences.</p>
<section id="build-distance-tree-disstree" class="level2">
<h2 class="anchored" data-anchor-id="build-distance-tree-disstree">Build Distance Tree (<code>disstree</code>)</h2>
<p><strong>What it does</strong>: Builds a tree from a pre-computed distance matrix. Use this when you already have distances calculated.</p>
<p><strong>When to use</strong>: When you want to reuse a distance matrix or have computed distances using a specific method.</p>
<p><strong>Corresponds to Sequenzo</strong>: <code>build_distance_tree()</code></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a distance tree</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The tree will automatically find the best splits based on predictors</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert distance matrix to dist object for disstree</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>dist_obj <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(dist_matrix)</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>tree <span class="ot">&lt;-</span> <span class="fu">disstree</span>(dist_obj <span class="sc">~</span> gender <span class="sc">+</span> age_group <span class="sc">+</span> education <span class="sc">+</span> income, </span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> predictors,</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">weights =</span> <span class="cn">NULL</span>,</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">min.size =</span> <span class="fl">0.1</span>,  <span class="co"># Minimum 10% of sequences in each node</span></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">max.depth =</span> <span class="dv">3</span>,   <span class="co"># Maximum 3 levels deep</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">R =</span> <span class="dv">100</span>,         <span class="co"># Permutations for significance testing</span></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">pval =</span> <span class="fl">0.1</span>,      <span class="co"># Only keep splits with p-value &lt; 0.1</span></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">weight.permutation =</span> <span class="st">"none"</span>,</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">squared =</span> <span class="cn">FALSE</span>)</span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"‚úÖ Tree built successfully!</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>‚úÖ Tree built successfully!</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Tree structure:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Tree structure:</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Dissimilarity tree:
 Parameters: min.size=6, max.depth=3, R=100, pval=0.1 
 Formula: dist_obj ~ gender + age_group + education + income 
 Global R2: 0.074871 

 Fitted tree: 

 |-- Root  (n: 60 disc: 0.27847) 
   |-&gt; income 0.042116 
             |-- &lt;= 40073    (n: 13 disc: 0.25657)[41] * 
             |-- &gt; 40073  (n: 47 disc: 0.26955) 
               |-&gt; income 0.043198 
                   |-- &lt;= 56969    (n: 39 disc: 0.26325)[54] * 
                   |-- &gt; 56969    (n: 8 disc: 0.23187)[9] * </code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at tree information</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Tree Information ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Tree Information ===</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Total sequences:"</span>, tree<span class="sc">$</span>info<span class="sc">$</span>n, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Total sequences: 60 </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of leaves:"</span>, <span class="fu">length</span>(<span class="fu">unique</span>(tree<span class="sc">$</span>fitted[, <span class="dv">1</span>])), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Number of leaves: 3 </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Global R¬≤:"</span>, tree<span class="sc">$</span>info<span class="sc">$</span>R2, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Global R¬≤: </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Parameters:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Parameters:</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tree<span class="sc">$</span>info<span class="sc">$</span>parameters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$min.size
[1] 6

$max.depth
[1] 3

$R
[1] 100

$pval
[1] 0.1</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at which sequences belong to which leaf nodes</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Sequence Assignments ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Sequence Assignments ===</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Each sequence is assigned to a leaf node:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Each sequence is assigned to a leaf node:</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(tree<span class="sc">$</span>fitted, <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   (fitted)
1         4
2         4
3         4
4         4
5         4
6         2
7         4
8         4
9         5
10        2</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Leaf distribution:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Leaf distribution:</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">table</span>(tree<span class="sc">$</span>fitted[, <span class="dv">1</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
 2  4  5 
13 39  8 </code></pre>
</div>
</div>
</section>
<section id="build-sequence-tree-seqtree" class="level2">
<h2 class="anchored" data-anchor-id="build-sequence-tree-seqtree">Build Sequence Tree (<code>seqtree</code>)</h2>
<p><strong>What it does</strong>: Builds a tree directly from sequence data. It automatically computes distances for you!</p>
<p><strong>When to use</strong>: When you want a simpler workflow - just pass sequences and predictors.</p>
<p><strong>Corresponds to Sequenzo</strong>: <code>build_sequence_tree()</code></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a sequence tree</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This is easier - we don't need to compute distances first!</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>seqtree_result <span class="ot">&lt;-</span> <span class="fu">seqtree</span>(seqdata <span class="sc">~</span> gender <span class="sc">+</span> age_group <span class="sc">+</span> education <span class="sc">+</span> income, </span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> predictors,</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">weighted =</span> <span class="cn">TRUE</span>,  <span class="co"># Use weights from seqdata if available</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">min.size =</span> <span class="fl">0.1</span>,</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">max.depth =</span> <span class="dv">3</span>,</span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">R =</span> <span class="dv">100</span>,</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">pval =</span> <span class="fl">0.1</span>,</span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">weight.permutation =</span> <span class="st">"replicate"</span>,</span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">seqdist.args =</span> <span class="fu">list</span>(<span class="at">method =</span> <span class="st">"LCS"</span>, <span class="at">norm =</span> <span class="st">"auto"</span>))</span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"‚úÖ Sequence tree built successfully!</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>‚úÖ Sequence tree built successfully!</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Tree structure:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Tree structure:</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(seqtree_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Dissimilarity tree:
 Parameters: min.size=6, max.depth=3, R=100, pval=0.1 
 Formula: seqdata ~ gender + age_group + education + income 
 Global R2: 0.074871 

 Fitted tree: 

 |-- Root  (n: 60 disc: 0.27847) 
   |-&gt; income 0.042116 
             |-- &lt;= 40073    (n: 13 disc: 0.25657)[(1,10)-(2,8)-(3,3)-(4,2)-(5,2)] * 
             |-- &gt; 40073  (n: 47 disc: 0.26955) 
               |-&gt; income 0.043198 
                   |-- &lt;= 56969    (n: 39 disc: 0.26325)[(1,13)-(2,3)-(3,5)-(4,4)] * 
                   |-- &gt; 56969    (n: 8 disc: 0.23187)[(1,24)-(2,1)] * </code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at sequence tree information</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Sequence Tree Information ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Sequence Tree Information ===</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Total sequences:"</span>, seqtree_result<span class="sc">$</span>info<span class="sc">$</span>n, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Total sequences: 60 </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of leaves:"</span>, <span class="fu">length</span>(<span class="fu">unique</span>(seqtree_result<span class="sc">$</span>fitted[, <span class="dv">1</span>])), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Number of leaves: 3 </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Global R¬≤:"</span>, seqtree_result<span class="sc">$</span>info<span class="sc">$</span>R2, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Global R¬≤: </code></pre>
</div>
</div>
</section>
</section>
<section id="extracting-information-from-trees" class="level1">
<h1>Extracting Information from Trees</h1>
<p>Once you‚Äôve built a tree, you‚Äôll want to extract useful information from it!</p>
<section id="get-leaf-membership-disstreeleaf" class="level2">
<h2 class="anchored" data-anchor-id="get-leaf-membership-disstreeleaf">Get Leaf Membership (<code>disstreeleaf</code>)</h2>
<p><strong>What it does</strong>: Gets which leaf node each sequence belongs to. You can get either numeric IDs or human-readable labels.</p>
<p><strong>When to use</strong>: When you want to know which group each sequence belongs to.</p>
<p><strong>Corresponds to Sequenzo</strong>: <code>get_leaf_membership()</code></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get leaf IDs (numeric)</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>leaf_ids <span class="ot">&lt;-</span> <span class="fu">disstreeleaf</span>(tree)</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Leaf IDs (first 10 sequences):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Leaf IDs (first 10 sequences):</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(leaf_ids[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 4 4 4 4 4 2 4 4 5 2</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Unique leaves:"</span>, <span class="fu">length</span>(<span class="fu">unique</span>(leaf_ids)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Unique leaves: 3 </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Distribution:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Distribution:</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">table</span>(leaf_ids))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>leaf_ids
 2  4  5 
13 39  8 </code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get leaf labels (human-readable)</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>leaf_labels <span class="ot">&lt;-</span> <span class="fu">disstreeleaf</span>(tree, <span class="at">label =</span> <span class="cn">TRUE</span>)</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Leaf labels (first 10 sequences):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Leaf labels (first 10 sequences):</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(leaf_labels, <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] income &gt; 40073 &amp; income &lt;= 56969 income &gt; 40073 &amp; income &lt;= 56969
 [3] income &gt; 40073 &amp; income &lt;= 56969 income &gt; 40073 &amp; income &lt;= 56969
 [5] income &gt; 40073 &amp; income &lt;= 56969 income &lt;= 40073                 
 [7] income &gt; 40073 &amp; income &lt;= 56969 income &gt; 40073 &amp; income &lt;= 56969
 [9] income &gt; 40073 &amp; income &gt; 56969  income &lt;= 40073                 
3 Levels: income &lt;= 40073 ... income &gt; 40073 &amp; income &gt; 56969</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Unique labels:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Unique labels:</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">unique</span>(leaf_labels))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] income &gt; 40073 &amp; income &lt;= 56969 income &lt;= 40073                 
[3] income &gt; 40073 &amp; income &gt; 56969 
3 Levels: income &lt;= 40073 ... income &gt; 40073 &amp; income &gt; 56969</code></pre>
</div>
</div>
</section>
<section id="get-classification-rules-disstree.get.rules" class="level2">
<h2 class="anchored" data-anchor-id="get-classification-rules-disstree.get.rules">Get Classification Rules (<code>disstree.get.rules</code>)</h2>
<p><strong>What it does</strong>: Converts the tree structure into R-readable rules. Each rule tells you what conditions lead to each leaf node.</p>
<p><strong>When to use</strong>: When you want to understand or explain the tree structure, or assign new sequences to leaves.</p>
<p><strong>Corresponds to Sequenzo</strong>: <code>get_classification_rules()</code></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get classification rules</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>rules <span class="ot">&lt;-</span> <span class="fu">disstree.get.rules</span>(tree, <span class="at">collapse =</span> <span class="st">"; "</span>)</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of rules:"</span>, <span class="fu">length</span>(rules), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Number of rules: 3 </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Classification Rules:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Classification Rules:</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="dv">5</span>, <span class="fu">length</span>(rules))) {</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Rule %d:</span><span class="sc">\n</span><span class="st">"</span>, i))</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"  "</span>, rules[i], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"  Interpretation: Sequences matching this rule belong to leaf"</span>, i, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Rule 1:
   income &lt;= 40073 
  Interpretation: Sequences matching this rule belong to leaf 1 

Rule 2:
   income &gt; 40073 &amp; income &lt;= 56969 
  Interpretation: Sequences matching this rule belong to leaf 2 

Rule 3:
   income &gt; 40073 &amp; income &gt; 56969 
  Interpretation: Sequences matching this rule belong to leaf 3 </code></pre>
</div>
</div>
</section>
<section id="assign-to-leaves-disstree.assign" class="level2">
<h2 class="anchored" data-anchor-id="assign-to-leaves-disstree.assign">Assign to Leaves (<code>disstree.assign</code>)</h2>
<p><strong>What it does</strong>: Uses classification rules to assign new sequences (or existing ones) to leaf nodes based on their predictor values.</p>
<p><strong>When to use</strong>: When you want to classify new sequences or verify assignments.</p>
<p><strong>Corresponds to Sequenzo</strong>: <code>assign_to_leaves()</code></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign sequences to leaves using rules</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This uses the same predictors we used to build the tree</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>assignments <span class="ot">&lt;-</span> <span class="fu">disstree.assign</span>(rules, predictors)</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Assignments (first 10 sequences):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Assignments (first 10 sequences):</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(assignments[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 2 2 2 2 2 1 2 2 3 1</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Note: Each number corresponds to a rule/leaf node</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Note: Each number corresponds to a rule/leaf node</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"NA means the sequence doesn't match any rule</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>NA means the sequence doesn't match any rule</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify that assignments match the tree's fitted values</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>tree_assignments <span class="ot">&lt;-</span> tree<span class="sc">$</span>fitted[, <span class="dv">1</span>]</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Comparing assignments:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Comparing assignments:</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"From tree:"</span>, tree_assignments[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>From tree: 4 4 4 4 4 </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"From rules:"</span>, assignments[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>From rules: 2 2 2 2 2 </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Match:"</span>, <span class="fu">all</span>(tree_assignments <span class="sc">==</span> assignments, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Match: FALSE </code></pre>
</div>
</div>
</section>
</section>
<section id="visualizing-trees" class="level1">
<h1>Visualizing Trees</h1>
<p>Visualization is crucial for understanding tree structures! TraMineR provides several ways to visualize trees.</p>
<section id="print-tree-print.disstree" class="level2">
<h2 class="anchored" data-anchor-id="print-tree-print.disstree">Print Tree (<code>print.disstree</code>)</h2>
<p><strong>What it does</strong>: Prints a text-based representation of the tree in your console.</p>
<p><strong>When to use</strong>: Quick visualization, or when you want a simple text output.</p>
<p><strong>Corresponds to Sequenzo</strong>: <code>print_tree()</code></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print tree structure</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tree, <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">medoid =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Dissimilarity tree:
 Parameters: min.size=6, max.depth=3, R=100, pval=0.1 
 Formula: dist_obj ~ gender + age_group + education + income 
 Global R2: 0.0749 

 Fitted tree: 

 |-- Root  (n: 60 disc: 0.278) 
   |-&gt; income 0.0421 
             |-- &lt;= 40073    (n: 13 disc: 0.257) * 
             |-- &gt; 40073  (n: 47 disc: 0.27) 
               |-&gt; income 0.0432 
                   |-- &lt;= 56969    (n: 39 disc: 0.263) * 
                   |-- &gt; 56969    (n: 8 disc: 0.232) * </code></pre>
</div>
</div>
</section>
<section id="plot-tree-seqtreedisplay-disstreedisplay" class="level2">
<h2 class="anchored" data-anchor-id="plot-tree-seqtreedisplay-disstreedisplay">Plot Tree (<code>seqtreedisplay</code> / <code>disstreedisplay</code>)</h2>
<p><strong>What it does</strong>: Creates a graphical visualization of the tree using GraphViz.</p>
<p><strong>When to use</strong>: When you want a visual representation for presentations or papers.</p>
<p><strong>Note</strong>: Requires GraphViz to be installed. For sequence trees, use <code>seqtreedisplay()</code>. For distance trees, use <code>disstreedisplay()</code>.</p>
<p><strong>Corresponds to Sequenzo</strong>: <code>plot_tree()</code></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot sequence tree using seqtreedisplay</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This creates a graphical visualization using GraphViz</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"[&gt;] Creating graphical visualization of sequence tree...</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[&gt;] Creating graphical visualization of sequence tree...</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seqtreedisplay</span>(seqtree_result, <span class="at">filename =</span> <span class="cn">NULL</span>, <span class="at">show.tree =</span> <span class="cn">TRUE</span>)</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"‚úÖ Sequence tree visualization created!</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>‚úÖ Sequence tree visualization created!</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot distance tree using disstreedisplay</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This creates a graphical visualization using GraphViz</span></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"[&gt;] Creating graphical visualization of distance tree...</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[&gt;] Creating graphical visualization of distance tree...</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">disstreedisplay</span>(tree, <span class="at">filename =</span> <span class="cn">NULL</span>, <span class="at">show.tree =</span> <span class="cn">TRUE</span>)</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"‚úÖ Distance tree visualization created!</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>‚úÖ Distance tree visualization created!</code></pre>
</div>
</div>
</section>
<section id="export-to-dot-disstree2dot-seqtree2dot" class="level2">
<h2 class="anchored" data-anchor-id="export-to-dot-disstree2dot-seqtree2dot">Export to DOT (<code>disstree2dot</code> / <code>seqtree2dot</code>)</h2>
<p><strong>What it does</strong>: Exports the tree to GraphViz DOT format, which can be rendered as high-quality images.</p>
<p><strong>When to use</strong>: When you need publication-quality figures or want to customize the visualization.</p>
<p><strong>Note</strong>: Requires GraphViz to be installed. For sequence trees, use <code>seqtree2dot()</code>. For distance trees, use <code>disstree2dot()</code>.</p>
<p><strong>Corresponds to Sequenzo</strong>: <code>export_tree_to_dot()</code></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Export sequence tree to DOT format</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"[&gt;] Exporting sequence tree to DOT format...</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[&gt;] Exporting sequence tree to DOT format...</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seqtree2dot</span>(seqtree_result, <span class="at">filename =</span> <span class="st">"tree_analysis_lsog_seqtree"</span>, <span class="at">show.depth =</span> <span class="cn">FALSE</span>)</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"‚úÖ DOT file created: tree_analysis_lsog_seqtree.dot</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>‚úÖ DOT file created: tree_analysis_lsog_seqtree.dot</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"To render: dot -Tpng tree_analysis_lsog_seqtree.dot -o tree_analysis_lsog_seqtree.png</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>To render: dot -Tpng tree_analysis_lsog_seqtree.dot -o tree_analysis_lsog_seqtree.png</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Export distance tree to DOT format</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"[&gt;] Exporting distance tree to DOT format...</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[&gt;] Exporting distance tree to DOT format...</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">disstree2dot</span>(tree, <span class="at">filename =</span> <span class="st">"tree_analysis_lsog_disstree"</span>, <span class="at">show.depth =</span> <span class="cn">FALSE</span>)</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"‚úÖ DOT file created: tree_analysis_lsog_disstree.dot</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>‚úÖ DOT file created: tree_analysis_lsog_disstree.dot</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"To render: dot -Tpng tree_analysis_lsog_disstree.dot -o tree_analysis_lsog_disstree.png</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>To render: dot -Tpng tree_analysis_lsog_disstree.dot -o tree_analysis_lsog_disstree.png</code></pre>
</div>
</div>
<p>&lt;ÔΩútool‚ñÅcalls‚ñÅbeginÔΩú&gt;&lt;ÔΩútool‚ñÅcall‚ñÅbeginÔΩú&gt; run_terminal_cmd</p>
</section>
</section>
<section id="complete-workflow-example" class="level1">
<h1>Complete Workflow Example</h1>
<p>Let‚Äôs put it all together! Here‚Äôs a complete example showing the typical workflow:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Load and prepare data</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the data_path defined earlier</span></span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(data_path, </span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>, <span class="at">check.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df[<span class="dv">1</span><span class="sc">:</span><span class="dv">60</span>, ]</span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a>time_cols <span class="ot">&lt;-</span> <span class="fu">names</span>(df)[<span class="fu">sapply</span>(<span class="fu">names</span>(df), <span class="cf">function</span>(x) {</span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a>    clean_x <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">"^X"</span>, <span class="st">""</span>, x)</span>
<span id="cb189-9"><a href="#cb189-9" aria-hidden="true" tabindex="-1"></a>    num_val <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">as.numeric</span>(clean_x))</span>
<span id="cb189-10"><a href="#cb189-10" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(num_val) <span class="sc">&amp;&amp;</span> clean_x <span class="sc">!=</span> <span class="st">""</span> <span class="sc">&amp;&amp;</span> x <span class="sc">!=</span> <span class="st">"dyadID"</span> <span class="sc">&amp;&amp;</span> x <span class="sc">!=</span> <span class="st">"sex"</span></span>
<span id="cb189-11"><a href="#cb189-11" aria-hidden="true" tabindex="-1"></a>})]</span>
<span id="cb189-12"><a href="#cb189-12" aria-hidden="true" tabindex="-1"></a>time_nums <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.numeric</span>(<span class="fu">sub</span>(<span class="st">"^X"</span>, <span class="st">""</span>, time_cols)))</span>
<span id="cb189-13"><a href="#cb189-13" aria-hidden="true" tabindex="-1"></a>time_cols <span class="ot">&lt;-</span> <span class="fu">as.character</span>(time_nums)</span>
<span id="cb189-14"><a href="#cb189-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">paste0</span>(<span class="st">"X"</span>, time_cols) <span class="sc">%in%</span> <span class="fu">names</span>(df))) {</span>
<span id="cb189-15"><a href="#cb189-15" aria-hidden="true" tabindex="-1"></a>    time_cols <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"X"</span>, time_cols)</span>
<span id="cb189-16"><a href="#cb189-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb189-17"><a href="#cb189-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-18"><a href="#cb189-18" aria-hidden="true" tabindex="-1"></a>seqdata <span class="ot">&lt;-</span> <span class="fu">seqdef</span>(df[, time_cols], <span class="at">alphabet =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, </span>
<span id="cb189-19"><a href="#cb189-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">states =</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"5"</span>, <span class="st">"6"</span>))</span>
<span id="cb189-20"><a href="#cb189-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-21"><a href="#cb189-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Create predictors</span></span>
<span id="cb189-22"><a href="#cb189-22" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb189-23"><a href="#cb189-23" aria-hidden="true" tabindex="-1"></a>predictors <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb189-24"><a href="#cb189-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">gender =</span> <span class="fu">factor</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"M"</span>, <span class="st">"F"</span>), <span class="at">size =</span> <span class="fu">nrow</span>(df), <span class="at">replace =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb189-25"><a href="#cb189-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">education =</span> <span class="fu">factor</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"low"</span>, <span class="st">"medium"</span>, <span class="st">"high"</span>), <span class="at">size =</span> <span class="fu">nrow</span>(df), <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb189-26"><a href="#cb189-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb189-27"><a href="#cb189-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-28"><a href="#cb189-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Build tree</span></span>
<span id="cb189-29"><a href="#cb189-29" aria-hidden="true" tabindex="-1"></a>tree <span class="ot">&lt;-</span> <span class="fu">seqtree</span>(seqdata <span class="sc">~</span> gender <span class="sc">+</span> education, <span class="at">data =</span> predictors,</span>
<span id="cb189-30"><a href="#cb189-30" aria-hidden="true" tabindex="-1"></a>                <span class="at">min.size =</span> <span class="fl">0.1</span>, <span class="at">max.depth =</span> <span class="dv">3</span>, <span class="at">R =</span> <span class="dv">100</span>, <span class="at">pval =</span> <span class="fl">0.1</span>)</span>
<span id="cb189-31"><a href="#cb189-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-32"><a href="#cb189-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Extract information</span></span>
<span id="cb189-33"><a href="#cb189-33" aria-hidden="true" tabindex="-1"></a>leaf_ids <span class="ot">&lt;-</span> <span class="fu">disstreeleaf</span>(tree)</span>
<span id="cb189-34"><a href="#cb189-34" aria-hidden="true" tabindex="-1"></a>rules <span class="ot">&lt;-</span> <span class="fu">disstree.get.rules</span>(tree)</span>
<span id="cb189-35"><a href="#cb189-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-36"><a href="#cb189-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Visualize</span></span>
<span id="cb189-37"><a href="#cb189-37" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Dissimilarity tree:
 Parameters: min.size=6, max.depth=3, R=100, pval=0.1 
 Formula: seqdata ~ gender + education 
 Global R2: 0 

 Fitted tree: 

 |-- Root    (n: 60 disc: 0.27847)[(1,13)-(2,3)-(3,5)-(4,4)] * </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">‚úÖ Complete workflow finished!</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
‚úÖ Complete workflow finished!</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Tree has"</span>, <span class="fu">length</span>(<span class="fu">unique</span>(leaf_ids)), <span class="st">"leaf nodes</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Tree has 1 leaf nodes</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Found"</span>, <span class="fu">length</span>(rules), <span class="st">"classification rules</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Found 1 classification rules</code></pre>
</div>
</div>
</section>
<section id="summary-and-next-steps" class="level1">
<h1>Summary and Next Steps</h1>
<p>Congratulations! üéâ You‚Äôve learned how to use TraMineR to:</p>
<ol type="1">
<li>‚úÖ Compute pseudo-variance to measure sequence diversity (<code>dissvar</code>)</li>
<li>‚úÖ Test associations between groups and sequence patterns (<code>dissassoc</code>)</li>
<li>‚úÖ Build regression trees from distance matrices and sequence data (<code>disstree</code>, <code>seqtree</code>)</li>
<li>‚úÖ Extract leaf memberships and classification rules (<code>disstreeleaf</code>, <code>disstree.get.rules</code>)</li>
<li>‚úÖ Visualize trees using text and plots (<code>print</code>, <code>plot</code>)</li>
</ol>
<section id="key-takeaways" class="level2">
<h2 class="anchored" data-anchor-id="key-takeaways">Key Takeaways</h2>
<ul>
<li><strong>Pseudo-variance</strong> (<code>dissvar</code>) tells you how diverse your sequences are</li>
<li><strong>Association tests</strong> (<code>dissassoc</code>) tell you if groups differ significantly</li>
<li><strong>Trees</strong> (<code>disstree</code>, <code>seqtree</code>) automatically find which factors explain sequence differences</li>
<li><strong>Rules</strong> (<code>disstree.get.rules</code>) help you understand and explain tree structures</li>
<li><strong>Visualization</strong> (<code>print</code>, <code>plot</code>) makes trees easy to understand and present</li>
</ul>
</section>
<section id="whats-next" class="level2">
<h2 class="anchored" data-anchor-id="whats-next">What‚Äôs Next?</h2>
<ul>
<li>Try different distance measures (OM, HAM, DHD)</li>
<li>Experiment with different predictor variables</li>
<li>Adjust tree parameters (min.size, max.depth, pval)</li>
<li>Compare results with Sequenzo Python implementation</li>
<li>Explore other TraMineR modules!</li>
</ul>
</section>
<section id="further-reading" class="level2">
<h2 class="anchored" data-anchor-id="further-reading">Further Reading</h2>
<ul>
<li>TraMineR documentation: https://traminer.unige.ch/</li>
<li>Studer et al.&nbsp;(2011): Discrepancy analysis of state sequences</li>
<li>TraMineR User‚Äôs Guide: Available in R with <code>vignette("TraMineR")</code></li>
</ul>
<p>Happy analyzing! üå≥‚ú®</p>
<!-- -->

</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb197" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Tree Analysis Tutorial: Understanding Sequence Patterns with Regression Trees"</span></span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Step-by-step guide using LSOG dyadic_children dataset - TraMineR (R) Implementation"</span></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Sequenzo Tutorial"</span></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> today</span></span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb197-10"><a href="#cb197-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb197-11"><a href="#cb197-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb197-12"><a href="#cb197-12" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cosmo</span></span>
<span id="cb197-13"><a href="#cb197-13" aria-hidden="true" tabindex="-1"></a><span class="co">  pdf:</span></span>
<span id="cb197-14"><a href="#cb197-14" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb197-15"><a href="#cb197-15" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb197-16"><a href="#cb197-16" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb197-17"><a href="#cb197-17" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb197-18"><a href="#cb197-18" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb197-19"><a href="#cb197-19" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb197-20"><a href="#cb197-20" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb197-21"><a href="#cb197-21" aria-hidden="true" tabindex="-1"></a><span class="co">  error: false</span></span>
<span id="cb197-22"><a href="#cb197-22" aria-hidden="true" tabindex="-1"></a><span class="co">  output: true</span></span>
<span id="cb197-23"><a href="#cb197-23" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb197-24"><a href="#cb197-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-25"><a href="#cb197-25" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction</span></span>
<span id="cb197-26"><a href="#cb197-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-27"><a href="#cb197-27" aria-hidden="true" tabindex="-1"></a>Welcome to the **Tree Analysis** tutorial using **TraMineR (R)**! üå≥</span>
<span id="cb197-28"><a href="#cb197-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-29"><a href="#cb197-29" aria-hidden="true" tabindex="-1"></a>This tutorial demonstrates how to use **regression trees** in TraMineR to understand how different factors (like age, gender, education) explain differences in sequence patterns. This R-based tutorial corresponds to the Python Sequenzo implementation.</span>
<span id="cb197-30"><a href="#cb197-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-31"><a href="#cb197-31" aria-hidden="true" tabindex="-1"></a><span class="fu">## What You'll Learn</span></span>
<span id="cb197-32"><a href="#cb197-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-33"><a href="#cb197-33" aria-hidden="true" tabindex="-1"></a>By the end of this tutorial, you'll know how to use TraMineR to:</span>
<span id="cb197-34"><a href="#cb197-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-35"><a href="#cb197-35" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Compute basic statistics** - Calculate variance (<span class="in">`dissvar`</span>) and test associations (<span class="in">`dissassoc`</span>)</span>
<span id="cb197-36"><a href="#cb197-36" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Build trees** - Create regression trees (<span class="in">`disstree`</span>, <span class="in">`seqtree`</span>)</span>
<span id="cb197-37"><a href="#cb197-37" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Extract insights** - Get classification rules (<span class="in">`disstree.get.rules`</span>) and assign sequences (<span class="in">`disstree.assign`</span>)</span>
<span id="cb197-38"><a href="#cb197-38" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Visualize results** - Plot and print trees</span>
<span id="cb197-39"><a href="#cb197-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-40"><a href="#cb197-40" aria-hidden="true" tabindex="-1"></a><span class="fu">## Dataset: LSOG Dyadic Children</span></span>
<span id="cb197-41"><a href="#cb197-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-42"><a href="#cb197-42" aria-hidden="true" tabindex="-1"></a>We'll use the **dyadic_children** dataset from the LSOG (Life Stories of Generations) study. This dataset contains sequences showing how children's living arrangements change from age 15 to 39. States represent different living situations (e.g., living with parents, alone, with partner).</span>
<span id="cb197-43"><a href="#cb197-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-44"><a href="#cb197-44" aria-hidden="true" tabindex="-1"></a><span class="fu">## Prerequisites</span></span>
<span id="cb197-45"><a href="#cb197-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-46"><a href="#cb197-46" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Basic R knowledge</span>
<span id="cb197-47"><a href="#cb197-47" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>TraMineR package installed</span>
<span id="cb197-48"><a href="#cb197-48" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Familiarity with sequence data</span>
<span id="cb197-49"><a href="#cb197-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-50"><a href="#cb197-50" aria-hidden="true" tabindex="-1"></a>Let's get started! üöÄ</span>
<span id="cb197-51"><a href="#cb197-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-52"><a href="#cb197-52" aria-hidden="true" tabindex="-1"></a><span class="fu"># Setup and Data Loading</span></span>
<span id="cb197-53"><a href="#cb197-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-54"><a href="#cb197-54" aria-hidden="true" tabindex="-1"></a>First, let's load the necessary R libraries and our data.</span>
<span id="cb197-55"><a href="#cb197-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-58"><a href="#cb197-58" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb197-59"><a href="#cb197-59" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: load-libraries</span></span>
<span id="cb197-60"><a href="#cb197-60" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb197-61"><a href="#cb197-61" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb197-62"><a href="#cb197-62" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb197-63"><a href="#cb197-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-64"><a href="#cb197-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Load TraMineR library</span></span>
<span id="cb197-65"><a href="#cb197-65" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(TraMineR)</span>
<span id="cb197-66"><a href="#cb197-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-67"><a href="#cb197-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb197-68"><a href="#cb197-68" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb197-69"><a href="#cb197-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-70"><a href="#cb197-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Define project root path (relative to this file location)</span></span>
<span id="cb197-71"><a href="#cb197-71" aria-hidden="true" tabindex="-1"></a>project_root <span class="ot">&lt;-</span> <span class="fu">normalizePath</span>(<span class="st">"../../"</span>)</span>
<span id="cb197-72"><a href="#cb197-72" aria-hidden="true" tabindex="-1"></a>data_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(project_root, <span class="st">"sequenzo/datasets/dyadic_children.csv"</span>)</span>
<span id="cb197-73"><a href="#cb197-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-74"><a href="#cb197-74" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"‚úÖ TraMineR loaded successfully!</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-75"><a href="#cb197-75" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"TraMineR version:"</span>, <span class="fu">as.character</span>(<span class="fu">packageVersion</span>(<span class="st">"TraMineR"</span>)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-76"><a href="#cb197-76" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Project root:"</span>, project_root, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-77"><a href="#cb197-77" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Data path:"</span>, data_path, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-78"><a href="#cb197-78" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb197-79"><a href="#cb197-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-82"><a href="#cb197-82" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb197-83"><a href="#cb197-83" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: load-data</span></span>
<span id="cb197-84"><a href="#cb197-84" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb197-85"><a href="#cb197-85" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb197-86"><a href="#cb197-86" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb197-87"><a href="#cb197-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-88"><a href="#cb197-88" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the dyadic_children dataset</span></span>
<span id="cb197-89"><a href="#cb197-89" aria-hidden="true" tabindex="-1"></a><span class="co"># Use check.names=FALSE to preserve numeric column names (15, 16, etc.)</span></span>
<span id="cb197-90"><a href="#cb197-90" aria-hidden="true" tabindex="-1"></a><span class="co"># Use absolute path relative to project root</span></span>
<span id="cb197-91"><a href="#cb197-91" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(data_path, </span>
<span id="cb197-92"><a href="#cb197-92" aria-hidden="true" tabindex="-1"></a>               <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>, </span>
<span id="cb197-93"><a href="#cb197-93" aria-hidden="true" tabindex="-1"></a>               <span class="at">check.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb197-94"><a href="#cb197-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-95"><a href="#cb197-95" aria-hidden="true" tabindex="-1"></a><span class="co"># For this tutorial, we'll use the first 60 rows for faster computation</span></span>
<span id="cb197-96"><a href="#cb197-96" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df[<span class="dv">1</span><span class="sc">:</span><span class="dv">60</span>, ]</span>
<span id="cb197-97"><a href="#cb197-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-98"><a href="#cb197-98" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Dataset loaded:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-99"><a href="#cb197-99" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Rows:"</span>, <span class="fu">nrow</span>(df), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-100"><a href="#cb197-100" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Columns:"</span>, <span class="fu">ncol</span>(df), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-101"><a href="#cb197-101" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">First few rows:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-102"><a href="#cb197-102" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df[, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>])</span>
<span id="cb197-103"><a href="#cb197-103" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb197-104"><a href="#cb197-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-107"><a href="#cb197-107" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb197-108"><a href="#cb197-108" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: extract-time-columns</span></span>
<span id="cb197-109"><a href="#cb197-109" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb197-110"><a href="#cb197-110" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb197-111"><a href="#cb197-111" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb197-112"><a href="#cb197-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-113"><a href="#cb197-113" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract time columns (ages 15-39)</span></span>
<span id="cb197-114"><a href="#cb197-114" aria-hidden="true" tabindex="-1"></a><span class="co"># Columns that are pure numbers (like "15", "16", etc.)</span></span>
<span id="cb197-115"><a href="#cb197-115" aria-hidden="true" tabindex="-1"></a>time_cols <span class="ot">&lt;-</span> <span class="fu">names</span>(df)[<span class="fu">sapply</span>(<span class="fu">names</span>(df), <span class="cf">function</span>(x) {</span>
<span id="cb197-116"><a href="#cb197-116" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove "X" prefix if present (R adds this for numeric column names)</span></span>
<span id="cb197-117"><a href="#cb197-117" aria-hidden="true" tabindex="-1"></a>    clean_x <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">"^X"</span>, <span class="st">""</span>, x)</span>
<span id="cb197-118"><a href="#cb197-118" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if column name is a pure number</span></span>
<span id="cb197-119"><a href="#cb197-119" aria-hidden="true" tabindex="-1"></a>    num_val <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">as.numeric</span>(clean_x))</span>
<span id="cb197-120"><a href="#cb197-120" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(num_val) <span class="sc">&amp;&amp;</span> clean_x <span class="sc">!=</span> <span class="st">""</span> <span class="sc">&amp;&amp;</span> x <span class="sc">!=</span> <span class="st">"dyadID"</span> <span class="sc">&amp;&amp;</span> x <span class="sc">!=</span> <span class="st">"sex"</span></span>
<span id="cb197-121"><a href="#cb197-121" aria-hidden="true" tabindex="-1"></a>})]</span>
<span id="cb197-122"><a href="#cb197-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-123"><a href="#cb197-123" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract numeric values and sort</span></span>
<span id="cb197-124"><a href="#cb197-124" aria-hidden="true" tabindex="-1"></a>time_nums <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.numeric</span>(<span class="fu">sub</span>(<span class="st">"^X"</span>, <span class="st">""</span>, time_cols)))</span>
<span id="cb197-125"><a href="#cb197-125" aria-hidden="true" tabindex="-1"></a>time_cols <span class="ot">&lt;-</span> <span class="fu">as.character</span>(time_nums)  <span class="co"># Use clean numeric names</span></span>
<span id="cb197-126"><a href="#cb197-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-127"><a href="#cb197-127" aria-hidden="true" tabindex="-1"></a><span class="co"># If R added "X" prefix, use those column names</span></span>
<span id="cb197-128"><a href="#cb197-128" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">paste0</span>(<span class="st">"X"</span>, time_cols) <span class="sc">%in%</span> <span class="fu">names</span>(df))) {</span>
<span id="cb197-129"><a href="#cb197-129" aria-hidden="true" tabindex="-1"></a>    time_cols <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"X"</span>, time_cols)</span>
<span id="cb197-130"><a href="#cb197-130" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb197-131"><a href="#cb197-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-132"><a href="#cb197-132" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Found %d time columns: %s ... %s</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb197-133"><a href="#cb197-133" aria-hidden="true" tabindex="-1"></a>            <span class="fu">length</span>(time_cols), time_cols[<span class="dv">1</span>], time_cols[<span class="fu">length</span>(time_cols)]))</span>
<span id="cb197-134"><a href="#cb197-134" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb197-135"><a href="#cb197-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-138"><a href="#cb197-138" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb197-139"><a href="#cb197-139" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: create-seqdata</span></span>
<span id="cb197-140"><a href="#cb197-140" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb197-141"><a href="#cb197-141" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb197-142"><a href="#cb197-142" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb197-143"><a href="#cb197-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-144"><a href="#cb197-144" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sequence object using seqdef</span></span>
<span id="cb197-145"><a href="#cb197-145" aria-hidden="true" tabindex="-1"></a><span class="co"># States are coded as 1-6 (different living arrangements)</span></span>
<span id="cb197-146"><a href="#cb197-146" aria-hidden="true" tabindex="-1"></a>seqdata <span class="ot">&lt;-</span> <span class="fu">seqdef</span>(df[, time_cols], </span>
<span id="cb197-147"><a href="#cb197-147" aria-hidden="true" tabindex="-1"></a>                  <span class="at">alphabet =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, </span>
<span id="cb197-148"><a href="#cb197-148" aria-hidden="true" tabindex="-1"></a>                  <span class="at">states =</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"5"</span>, <span class="st">"6"</span>))</span>
<span id="cb197-149"><a href="#cb197-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-150"><a href="#cb197-150" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"‚úÖ Sequence object created!</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-151"><a href="#cb197-151" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Number of sequences:"</span>, <span class="fu">nrow</span>(seqdata), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-152"><a href="#cb197-152" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Sequence length:"</span>, <span class="fu">ncol</span>(seqdata), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-153"><a href="#cb197-153" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  States:"</span>, <span class="fu">alphabet</span>(seqdata), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-154"><a href="#cb197-154" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb197-155"><a href="#cb197-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-158"><a href="#cb197-158" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb197-159"><a href="#cb197-159" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: create-predictors</span></span>
<span id="cb197-160"><a href="#cb197-160" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb197-161"><a href="#cb197-161" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb197-162"><a href="#cb197-162" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb197-163"><a href="#cb197-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-164"><a href="#cb197-164" aria-hidden="true" tabindex="-1"></a><span class="co"># Create predictor variables (covariates)</span></span>
<span id="cb197-165"><a href="#cb197-165" aria-hidden="true" tabindex="-1"></a><span class="co"># These are the factors we want to test: do they explain differences in sequences?</span></span>
<span id="cb197-166"><a href="#cb197-166" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb197-167"><a href="#cb197-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-168"><a href="#cb197-168" aria-hidden="true" tabindex="-1"></a>predictors <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb197-169"><a href="#cb197-169" aria-hidden="true" tabindex="-1"></a>    <span class="at">gender =</span> <span class="fu">factor</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"M"</span>, <span class="st">"F"</span>), <span class="at">size =</span> <span class="fu">nrow</span>(df), <span class="at">replace =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb197-170"><a href="#cb197-170" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_group =</span> <span class="fu">factor</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"young"</span>, <span class="st">"middle"</span>, <span class="st">"old"</span>), <span class="at">size =</span> <span class="fu">nrow</span>(df), <span class="at">replace =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb197-171"><a href="#cb197-171" aria-hidden="true" tabindex="-1"></a>    <span class="at">education =</span> <span class="fu">factor</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"low"</span>, <span class="st">"medium"</span>, <span class="st">"high"</span>), <span class="at">size =</span> <span class="fu">nrow</span>(df), <span class="at">replace =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb197-172"><a href="#cb197-172" aria-hidden="true" tabindex="-1"></a>    <span class="at">income =</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(df)) <span class="sc">*</span> <span class="dv">10000</span> <span class="sc">+</span> <span class="dv">50000</span>  <span class="co"># Continuous variable</span></span>
<span id="cb197-173"><a href="#cb197-173" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb197-174"><a href="#cb197-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-175"><a href="#cb197-175" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"‚úÖ Predictors created:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-176"><a href="#cb197-176" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(predictors))</span>
<span id="cb197-177"><a href="#cb197-177" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Predictor types:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-178"><a href="#cb197-178" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(predictors)</span>
<span id="cb197-179"><a href="#cb197-179" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb197-180"><a href="#cb197-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-181"><a href="#cb197-181" aria-hidden="true" tabindex="-1"></a><span class="fu"># Basic Utility Functions</span></span>
<span id="cb197-182"><a href="#cb197-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-183"><a href="#cb197-183" aria-hidden="true" tabindex="-1"></a>Before building trees, let's learn about two fundamental TraMineR functions that help us understand sequence variability and associations.</span>
<span id="cb197-184"><a href="#cb197-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-185"><a href="#cb197-185" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compute Pseudo-Variance (`dissvar`)</span></span>
<span id="cb197-186"><a href="#cb197-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-187"><a href="#cb197-187" aria-hidden="true" tabindex="-1"></a>**What it does**: Measures how "spread out" sequences are in terms of their distances from each other. Think of it like variance, but for sequences!</span>
<span id="cb197-188"><a href="#cb197-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-189"><a href="#cb197-189" aria-hidden="true" tabindex="-1"></a>**When to use**: When you want to know how diverse or similar your sequences are overall.</span>
<span id="cb197-190"><a href="#cb197-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-191"><a href="#cb197-191" aria-hidden="true" tabindex="-1"></a>**Corresponds to Sequenzo**: <span class="in">`compute_pseudo_variance()`</span></span>
<span id="cb197-192"><a href="#cb197-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-195"><a href="#cb197-195" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb197-196"><a href="#cb197-196" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: compute-distance-matrix</span></span>
<span id="cb197-197"><a href="#cb197-197" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb197-198"><a href="#cb197-198" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb197-199"><a href="#cb197-199" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb197-200"><a href="#cb197-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-201"><a href="#cb197-201" aria-hidden="true" tabindex="-1"></a><span class="co"># First, compute a distance matrix</span></span>
<span id="cb197-202"><a href="#cb197-202" aria-hidden="true" tabindex="-1"></a><span class="co"># This tells us how "different" each pair of sequences is</span></span>
<span id="cb197-203"><a href="#cb197-203" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"[&gt;] Computing distance matrix using LCS method...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-204"><a href="#cb197-204" aria-hidden="true" tabindex="-1"></a>dist_matrix <span class="ot">&lt;-</span> <span class="fu">seqdist</span>(seqdata, <span class="at">method =</span> <span class="st">"LCS"</span>, <span class="at">norm =</span> <span class="st">"auto"</span>)</span>
<span id="cb197-205"><a href="#cb197-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-206"><a href="#cb197-206" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"‚úÖ Distance matrix computed:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-207"><a href="#cb197-207" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Dimensions:"</span>, <span class="fu">dim</span>(dist_matrix), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-208"><a href="#cb197-208" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Class:"</span>, <span class="fu">class</span>(dist_matrix), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-209"><a href="#cb197-209" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb197-210"><a href="#cb197-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-213"><a href="#cb197-213" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb197-214"><a href="#cb197-214" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: dissvar-unweighted</span></span>
<span id="cb197-215"><a href="#cb197-215" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb197-216"><a href="#cb197-216" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb197-217"><a href="#cb197-217" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb197-218"><a href="#cb197-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-219"><a href="#cb197-219" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute pseudo-variance (unweighted)</span></span>
<span id="cb197-220"><a href="#cb197-220" aria-hidden="true" tabindex="-1"></a>variance <span class="ot">&lt;-</span> <span class="fu">dissvar</span>(dist_matrix, <span class="at">weights =</span> <span class="cn">NULL</span>, <span class="at">squared =</span> <span class="cn">FALSE</span>)</span>
<span id="cb197-221"><a href="#cb197-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-222"><a href="#cb197-222" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pseudo-variance (unweighted):"</span>, variance, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-223"><a href="#cb197-223" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Interpretation: This value represents the average 'spread' of sequences.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-224"><a href="#cb197-224" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Higher values = more diverse sequences</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-225"><a href="#cb197-225" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Lower values = more similar sequences</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-226"><a href="#cb197-226" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb197-227"><a href="#cb197-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-230"><a href="#cb197-230" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb197-231"><a href="#cb197-231" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: dissvar-weighted</span></span>
<span id="cb197-232"><a href="#cb197-232" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb197-233"><a href="#cb197-233" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb197-234"><a href="#cb197-234" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb197-235"><a href="#cb197-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-236"><a href="#cb197-236" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute pseudo-variance with weights</span></span>
<span id="cb197-237"><a href="#cb197-237" aria-hidden="true" tabindex="-1"></a><span class="co"># This is useful when some sequences are more important than others</span></span>
<span id="cb197-238"><a href="#cb197-238" aria-hidden="true" tabindex="-1"></a>weights <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fl">2.0</span>, <span class="fu">nrow</span>(seqdata))</span>
<span id="cb197-239"><a href="#cb197-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-240"><a href="#cb197-240" aria-hidden="true" tabindex="-1"></a>variance_weighted <span class="ot">&lt;-</span> <span class="fu">dissvar</span>(dist_matrix, <span class="at">weights =</span> weights, <span class="at">squared =</span> <span class="cn">FALSE</span>)</span>
<span id="cb197-241"><a href="#cb197-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-242"><a href="#cb197-242" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pseudo-variance (weighted, all weights=2):"</span>, variance_weighted, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-243"><a href="#cb197-243" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Note: With equal weights, weighted variance ‚âà unweighted variance</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-244"><a href="#cb197-244" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb197-245"><a href="#cb197-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-248"><a href="#cb197-248" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb197-249"><a href="#cb197-249" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: dissvar-squared</span></span>
<span id="cb197-250"><a href="#cb197-250" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb197-251"><a href="#cb197-251" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb197-252"><a href="#cb197-252" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb197-253"><a href="#cb197-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-254"><a href="#cb197-254" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute pseudo-variance with squared distances</span></span>
<span id="cb197-255"><a href="#cb197-255" aria-hidden="true" tabindex="-1"></a><span class="co"># Squaring emphasizes larger differences</span></span>
<span id="cb197-256"><a href="#cb197-256" aria-hidden="true" tabindex="-1"></a>variance_squared <span class="ot">&lt;-</span> <span class="fu">dissvar</span>(dist_matrix, <span class="at">weights =</span> <span class="cn">NULL</span>, <span class="at">squared =</span> <span class="cn">TRUE</span>)</span>
<span id="cb197-257"><a href="#cb197-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-258"><a href="#cb197-258" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pseudo-variance (squared):"</span>, variance_squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-259"><a href="#cb197-259" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pseudo-variance (normal):"</span>, variance, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-260"><a href="#cb197-260" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Note: Squared variance is typically larger because it emphasizes big differences</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-261"><a href="#cb197-261" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb197-262"><a href="#cb197-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-263"><a href="#cb197-263" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compute Distance Association (`dissassoc`)</span></span>
<span id="cb197-264"><a href="#cb197-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-265"><a href="#cb197-265" aria-hidden="true" tabindex="-1"></a>**What it does**: Tests whether a grouping variable (like gender or age group) explains differences in sequence patterns. It's like ANOVA, but for sequences!</span>
<span id="cb197-266"><a href="#cb197-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-267"><a href="#cb197-267" aria-hidden="true" tabindex="-1"></a>**When to use**: When you want to know if sequences in different groups (e.g., men vs. women) are significantly different.</span>
<span id="cb197-268"><a href="#cb197-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-269"><a href="#cb197-269" aria-hidden="true" tabindex="-1"></a>**Corresponds to Sequenzo**: <span class="in">`compute_distance_association()`</span></span>
<span id="cb197-270"><a href="#cb197-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-273"><a href="#cb197-273" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb197-274"><a href="#cb197-274" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: dissassoc-basic</span></span>
<span id="cb197-275"><a href="#cb197-275" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb197-276"><a href="#cb197-276" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb197-277"><a href="#cb197-277" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb197-278"><a href="#cb197-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-279"><a href="#cb197-279" aria-hidden="true" tabindex="-1"></a><span class="co"># Test association between sequences and gender</span></span>
<span id="cb197-280"><a href="#cb197-280" aria-hidden="true" tabindex="-1"></a><span class="co"># This tells us: do men and women have different sequence patterns?</span></span>
<span id="cb197-281"><a href="#cb197-281" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span> predictors<span class="sc">$</span>gender</span>
<span id="cb197-282"><a href="#cb197-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-283"><a href="#cb197-283" aria-hidden="true" tabindex="-1"></a><span class="co"># Run dissassoc</span></span>
<span id="cb197-284"><a href="#cb197-284" aria-hidden="true" tabindex="-1"></a>assoc_result <span class="ot">&lt;-</span> <span class="fu">dissassoc</span>(dist_matrix, groups, </span>
<span id="cb197-285"><a href="#cb197-285" aria-hidden="true" tabindex="-1"></a>                          <span class="at">weights =</span> <span class="cn">NULL</span>, </span>
<span id="cb197-286"><a href="#cb197-286" aria-hidden="true" tabindex="-1"></a>                          <span class="at">R =</span> <span class="dv">100</span>,  <span class="co"># Number of permutations (smaller for speed)</span></span>
<span id="cb197-287"><a href="#cb197-287" aria-hidden="true" tabindex="-1"></a>                          <span class="at">weight.permutation =</span> <span class="st">"none"</span>, </span>
<span id="cb197-288"><a href="#cb197-288" aria-hidden="true" tabindex="-1"></a>                          <span class="at">squared =</span> <span class="cn">FALSE</span>)</span>
<span id="cb197-289"><a href="#cb197-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-290"><a href="#cb197-290" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Association Test Results ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-291"><a href="#cb197-291" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pseudo F-statistic:"</span>, assoc_result<span class="sc">$</span>stat[<span class="st">"Pseudo F"</span>, <span class="st">"t0"</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-292"><a href="#cb197-292" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pseudo R¬≤:"</span>, assoc_result<span class="sc">$</span>stat[<span class="st">"Pseudo R2"</span>, <span class="st">"t0"</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-293"><a href="#cb197-293" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"P-value:"</span>, assoc_result<span class="sc">$</span>stat[<span class="st">"Pseudo F"</span>, <span class="st">"p.value"</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-294"><a href="#cb197-294" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Interpretation:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-295"><a href="#cb197-295" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Pseudo R¬≤:"</span>, <span class="fu">round</span>(assoc_result<span class="sc">$</span>stat[<span class="st">"Pseudo R2"</span>, <span class="st">"t0"</span>] <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), </span>
<span id="cb197-296"><a href="#cb197-296" aria-hidden="true" tabindex="-1"></a>    <span class="st">"% of variance explained by gender</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-297"><a href="#cb197-297" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- P-value:"</span>, <span class="fu">ifelse</span>(assoc_result<span class="sc">$</span>stat[<span class="st">"Pseudo F"</span>, <span class="st">"p.value"</span>] <span class="sc">&lt;</span> <span class="fl">0.05</span>, </span>
<span id="cb197-298"><a href="#cb197-298" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"Significant"</span>, <span class="st">"Not significant"</span>), <span class="st">"(p &lt; 0.05)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-299"><a href="#cb197-299" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb197-300"><a href="#cb197-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-303"><a href="#cb197-303" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb197-304"><a href="#cb197-304" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: dissassoc-details</span></span>
<span id="cb197-305"><a href="#cb197-305" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb197-306"><a href="#cb197-306" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb197-307"><a href="#cb197-307" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb197-308"><a href="#cb197-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-309"><a href="#cb197-309" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at detailed results</span></span>
<span id="cb197-310"><a href="#cb197-310" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Statistics Table ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-311"><a href="#cb197-311" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(assoc_result<span class="sc">$</span>stat)</span>
<span id="cb197-312"><a href="#cb197-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-313"><a href="#cb197-313" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Group Information ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-314"><a href="#cb197-314" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(assoc_result<span class="sc">$</span>groups)</span>
<span id="cb197-315"><a href="#cb197-315" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb197-316"><a href="#cb197-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-317"><a href="#cb197-317" aria-hidden="true" tabindex="-1"></a><span class="fu"># Building Regression Trees</span></span>
<span id="cb197-318"><a href="#cb197-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-319"><a href="#cb197-319" aria-hidden="true" tabindex="-1"></a>Now for the exciting part! We'll build regression trees that automatically find which factors best explain differences in sequences.</span>
<span id="cb197-320"><a href="#cb197-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-321"><a href="#cb197-321" aria-hidden="true" tabindex="-1"></a><span class="fu">## Build Distance Tree (`disstree`)</span></span>
<span id="cb197-322"><a href="#cb197-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-323"><a href="#cb197-323" aria-hidden="true" tabindex="-1"></a>**What it does**: Builds a tree from a pre-computed distance matrix. Use this when you already have distances calculated.</span>
<span id="cb197-324"><a href="#cb197-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-325"><a href="#cb197-325" aria-hidden="true" tabindex="-1"></a>**When to use**: When you want to reuse a distance matrix or have computed distances using a specific method.</span>
<span id="cb197-326"><a href="#cb197-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-327"><a href="#cb197-327" aria-hidden="true" tabindex="-1"></a>**Corresponds to Sequenzo**: <span class="in">`build_distance_tree()`</span></span>
<span id="cb197-328"><a href="#cb197-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-331"><a href="#cb197-331" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb197-332"><a href="#cb197-332" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: build-disstree</span></span>
<span id="cb197-333"><a href="#cb197-333" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb197-334"><a href="#cb197-334" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb197-335"><a href="#cb197-335" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb197-336"><a href="#cb197-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-337"><a href="#cb197-337" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a distance tree</span></span>
<span id="cb197-338"><a href="#cb197-338" aria-hidden="true" tabindex="-1"></a><span class="co"># The tree will automatically find the best splits based on predictors</span></span>
<span id="cb197-339"><a href="#cb197-339" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert distance matrix to dist object for disstree</span></span>
<span id="cb197-340"><a href="#cb197-340" aria-hidden="true" tabindex="-1"></a>dist_obj <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(dist_matrix)</span>
<span id="cb197-341"><a href="#cb197-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-342"><a href="#cb197-342" aria-hidden="true" tabindex="-1"></a>tree <span class="ot">&lt;-</span> <span class="fu">disstree</span>(dist_obj <span class="sc">~</span> gender <span class="sc">+</span> age_group <span class="sc">+</span> education <span class="sc">+</span> income, </span>
<span id="cb197-343"><a href="#cb197-343" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> predictors,</span>
<span id="cb197-344"><a href="#cb197-344" aria-hidden="true" tabindex="-1"></a>                 <span class="at">weights =</span> <span class="cn">NULL</span>,</span>
<span id="cb197-345"><a href="#cb197-345" aria-hidden="true" tabindex="-1"></a>                 <span class="at">min.size =</span> <span class="fl">0.1</span>,  <span class="co"># Minimum 10% of sequences in each node</span></span>
<span id="cb197-346"><a href="#cb197-346" aria-hidden="true" tabindex="-1"></a>                 <span class="at">max.depth =</span> <span class="dv">3</span>,   <span class="co"># Maximum 3 levels deep</span></span>
<span id="cb197-347"><a href="#cb197-347" aria-hidden="true" tabindex="-1"></a>                 <span class="at">R =</span> <span class="dv">100</span>,         <span class="co"># Permutations for significance testing</span></span>
<span id="cb197-348"><a href="#cb197-348" aria-hidden="true" tabindex="-1"></a>                 <span class="at">pval =</span> <span class="fl">0.1</span>,      <span class="co"># Only keep splits with p-value &lt; 0.1</span></span>
<span id="cb197-349"><a href="#cb197-349" aria-hidden="true" tabindex="-1"></a>                 <span class="at">weight.permutation =</span> <span class="st">"none"</span>,</span>
<span id="cb197-350"><a href="#cb197-350" aria-hidden="true" tabindex="-1"></a>                 <span class="at">squared =</span> <span class="cn">FALSE</span>)</span>
<span id="cb197-351"><a href="#cb197-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-352"><a href="#cb197-352" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"‚úÖ Tree built successfully!</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-353"><a href="#cb197-353" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Tree structure:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-354"><a href="#cb197-354" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tree)</span>
<span id="cb197-355"><a href="#cb197-355" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb197-356"><a href="#cb197-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-359"><a href="#cb197-359" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb197-360"><a href="#cb197-360" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tree-info</span></span>
<span id="cb197-361"><a href="#cb197-361" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb197-362"><a href="#cb197-362" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb197-363"><a href="#cb197-363" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb197-364"><a href="#cb197-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-365"><a href="#cb197-365" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at tree information</span></span>
<span id="cb197-366"><a href="#cb197-366" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Tree Information ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-367"><a href="#cb197-367" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Total sequences:"</span>, tree<span class="sc">$</span>info<span class="sc">$</span>n, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-368"><a href="#cb197-368" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of leaves:"</span>, <span class="fu">length</span>(<span class="fu">unique</span>(tree<span class="sc">$</span>fitted[, <span class="dv">1</span>])), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-369"><a href="#cb197-369" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Global R¬≤:"</span>, tree<span class="sc">$</span>info<span class="sc">$</span>R2, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-370"><a href="#cb197-370" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Parameters:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-371"><a href="#cb197-371" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tree<span class="sc">$</span>info<span class="sc">$</span>parameters)</span>
<span id="cb197-372"><a href="#cb197-372" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb197-373"><a href="#cb197-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-376"><a href="#cb197-376" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb197-377"><a href="#cb197-377" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tree-fitted</span></span>
<span id="cb197-378"><a href="#cb197-378" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb197-379"><a href="#cb197-379" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb197-380"><a href="#cb197-380" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb197-381"><a href="#cb197-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-382"><a href="#cb197-382" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at which sequences belong to which leaf nodes</span></span>
<span id="cb197-383"><a href="#cb197-383" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Sequence Assignments ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-384"><a href="#cb197-384" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Each sequence is assigned to a leaf node:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-385"><a href="#cb197-385" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(tree<span class="sc">$</span>fitted, <span class="dv">10</span>))</span>
<span id="cb197-386"><a href="#cb197-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-387"><a href="#cb197-387" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Leaf distribution:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-388"><a href="#cb197-388" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">table</span>(tree<span class="sc">$</span>fitted[, <span class="dv">1</span>]))</span>
<span id="cb197-389"><a href="#cb197-389" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb197-390"><a href="#cb197-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-391"><a href="#cb197-391" aria-hidden="true" tabindex="-1"></a><span class="fu">## Build Sequence Tree (`seqtree`)</span></span>
<span id="cb197-392"><a href="#cb197-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-393"><a href="#cb197-393" aria-hidden="true" tabindex="-1"></a>**What it does**: Builds a tree directly from sequence data. It automatically computes distances for you!</span>
<span id="cb197-394"><a href="#cb197-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-395"><a href="#cb197-395" aria-hidden="true" tabindex="-1"></a>**When to use**: When you want a simpler workflow - just pass sequences and predictors.</span>
<span id="cb197-396"><a href="#cb197-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-397"><a href="#cb197-397" aria-hidden="true" tabindex="-1"></a>**Corresponds to Sequenzo**: <span class="in">`build_sequence_tree()`</span></span>
<span id="cb197-398"><a href="#cb197-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-401"><a href="#cb197-401" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb197-402"><a href="#cb197-402" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: build-seqtree</span></span>
<span id="cb197-403"><a href="#cb197-403" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb197-404"><a href="#cb197-404" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb197-405"><a href="#cb197-405" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb197-406"><a href="#cb197-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-407"><a href="#cb197-407" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a sequence tree</span></span>
<span id="cb197-408"><a href="#cb197-408" aria-hidden="true" tabindex="-1"></a><span class="co"># This is easier - we don't need to compute distances first!</span></span>
<span id="cb197-409"><a href="#cb197-409" aria-hidden="true" tabindex="-1"></a>seqtree_result <span class="ot">&lt;-</span> <span class="fu">seqtree</span>(seqdata <span class="sc">~</span> gender <span class="sc">+</span> age_group <span class="sc">+</span> education <span class="sc">+</span> income, </span>
<span id="cb197-410"><a href="#cb197-410" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> predictors,</span>
<span id="cb197-411"><a href="#cb197-411" aria-hidden="true" tabindex="-1"></a>                          <span class="at">weighted =</span> <span class="cn">TRUE</span>,  <span class="co"># Use weights from seqdata if available</span></span>
<span id="cb197-412"><a href="#cb197-412" aria-hidden="true" tabindex="-1"></a>                          <span class="at">min.size =</span> <span class="fl">0.1</span>,</span>
<span id="cb197-413"><a href="#cb197-413" aria-hidden="true" tabindex="-1"></a>                          <span class="at">max.depth =</span> <span class="dv">3</span>,</span>
<span id="cb197-414"><a href="#cb197-414" aria-hidden="true" tabindex="-1"></a>                          <span class="at">R =</span> <span class="dv">100</span>,</span>
<span id="cb197-415"><a href="#cb197-415" aria-hidden="true" tabindex="-1"></a>                          <span class="at">pval =</span> <span class="fl">0.1</span>,</span>
<span id="cb197-416"><a href="#cb197-416" aria-hidden="true" tabindex="-1"></a>                          <span class="at">weight.permutation =</span> <span class="st">"replicate"</span>,</span>
<span id="cb197-417"><a href="#cb197-417" aria-hidden="true" tabindex="-1"></a>                          <span class="at">seqdist.args =</span> <span class="fu">list</span>(<span class="at">method =</span> <span class="st">"LCS"</span>, <span class="at">norm =</span> <span class="st">"auto"</span>))</span>
<span id="cb197-418"><a href="#cb197-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-419"><a href="#cb197-419" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"‚úÖ Sequence tree built successfully!</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-420"><a href="#cb197-420" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Tree structure:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-421"><a href="#cb197-421" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(seqtree_result)</span>
<span id="cb197-422"><a href="#cb197-422" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb197-423"><a href="#cb197-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-426"><a href="#cb197-426" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb197-427"><a href="#cb197-427" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: seqtree-info</span></span>
<span id="cb197-428"><a href="#cb197-428" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb197-429"><a href="#cb197-429" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb197-430"><a href="#cb197-430" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb197-431"><a href="#cb197-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-432"><a href="#cb197-432" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at sequence tree information</span></span>
<span id="cb197-433"><a href="#cb197-433" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Sequence Tree Information ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-434"><a href="#cb197-434" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Total sequences:"</span>, seqtree_result<span class="sc">$</span>info<span class="sc">$</span>n, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-435"><a href="#cb197-435" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of leaves:"</span>, <span class="fu">length</span>(<span class="fu">unique</span>(seqtree_result<span class="sc">$</span>fitted[, <span class="dv">1</span>])), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-436"><a href="#cb197-436" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Global R¬≤:"</span>, seqtree_result<span class="sc">$</span>info<span class="sc">$</span>R2, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-437"><a href="#cb197-437" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb197-438"><a href="#cb197-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-439"><a href="#cb197-439" aria-hidden="true" tabindex="-1"></a><span class="fu"># Extracting Information from Trees</span></span>
<span id="cb197-440"><a href="#cb197-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-441"><a href="#cb197-441" aria-hidden="true" tabindex="-1"></a>Once you've built a tree, you'll want to extract useful information from it!</span>
<span id="cb197-442"><a href="#cb197-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-443"><a href="#cb197-443" aria-hidden="true" tabindex="-1"></a><span class="fu">## Get Leaf Membership (`disstreeleaf`)</span></span>
<span id="cb197-444"><a href="#cb197-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-445"><a href="#cb197-445" aria-hidden="true" tabindex="-1"></a>**What it does**: Gets which leaf node each sequence belongs to. You can get either numeric IDs or human-readable labels.</span>
<span id="cb197-446"><a href="#cb197-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-447"><a href="#cb197-447" aria-hidden="true" tabindex="-1"></a>**When to use**: When you want to know which group each sequence belongs to.</span>
<span id="cb197-448"><a href="#cb197-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-449"><a href="#cb197-449" aria-hidden="true" tabindex="-1"></a>**Corresponds to Sequenzo**: <span class="in">`get_leaf_membership()`</span></span>
<span id="cb197-450"><a href="#cb197-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-453"><a href="#cb197-453" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb197-454"><a href="#cb197-454" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: leaf-membership-ids</span></span>
<span id="cb197-455"><a href="#cb197-455" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb197-456"><a href="#cb197-456" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb197-457"><a href="#cb197-457" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb197-458"><a href="#cb197-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-459"><a href="#cb197-459" aria-hidden="true" tabindex="-1"></a><span class="co"># Get leaf IDs (numeric)</span></span>
<span id="cb197-460"><a href="#cb197-460" aria-hidden="true" tabindex="-1"></a>leaf_ids <span class="ot">&lt;-</span> <span class="fu">disstreeleaf</span>(tree)</span>
<span id="cb197-461"><a href="#cb197-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-462"><a href="#cb197-462" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Leaf IDs (first 10 sequences):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-463"><a href="#cb197-463" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(leaf_ids[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>])</span>
<span id="cb197-464"><a href="#cb197-464" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Unique leaves:"</span>, <span class="fu">length</span>(<span class="fu">unique</span>(leaf_ids)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-465"><a href="#cb197-465" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Distribution:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-466"><a href="#cb197-466" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">table</span>(leaf_ids))</span>
<span id="cb197-467"><a href="#cb197-467" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb197-468"><a href="#cb197-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-471"><a href="#cb197-471" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb197-472"><a href="#cb197-472" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: leaf-membership-labels</span></span>
<span id="cb197-473"><a href="#cb197-473" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb197-474"><a href="#cb197-474" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb197-475"><a href="#cb197-475" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb197-476"><a href="#cb197-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-477"><a href="#cb197-477" aria-hidden="true" tabindex="-1"></a><span class="co"># Get leaf labels (human-readable)</span></span>
<span id="cb197-478"><a href="#cb197-478" aria-hidden="true" tabindex="-1"></a>leaf_labels <span class="ot">&lt;-</span> <span class="fu">disstreeleaf</span>(tree, <span class="at">label =</span> <span class="cn">TRUE</span>)</span>
<span id="cb197-479"><a href="#cb197-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-480"><a href="#cb197-480" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Leaf labels (first 10 sequences):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-481"><a href="#cb197-481" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(leaf_labels, <span class="dv">10</span>))</span>
<span id="cb197-482"><a href="#cb197-482" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Unique labels:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-483"><a href="#cb197-483" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">unique</span>(leaf_labels))</span>
<span id="cb197-484"><a href="#cb197-484" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb197-485"><a href="#cb197-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-486"><a href="#cb197-486" aria-hidden="true" tabindex="-1"></a><span class="fu">## Get Classification Rules (`disstree.get.rules`)</span></span>
<span id="cb197-487"><a href="#cb197-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-488"><a href="#cb197-488" aria-hidden="true" tabindex="-1"></a>**What it does**: Converts the tree structure into R-readable rules. Each rule tells you what conditions lead to each leaf node.</span>
<span id="cb197-489"><a href="#cb197-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-490"><a href="#cb197-490" aria-hidden="true" tabindex="-1"></a>**When to use**: When you want to understand or explain the tree structure, or assign new sequences to leaves.</span>
<span id="cb197-491"><a href="#cb197-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-492"><a href="#cb197-492" aria-hidden="true" tabindex="-1"></a>**Corresponds to Sequenzo**: <span class="in">`get_classification_rules()`</span></span>
<span id="cb197-493"><a href="#cb197-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-496"><a href="#cb197-496" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb197-497"><a href="#cb197-497" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: classification-rules</span></span>
<span id="cb197-498"><a href="#cb197-498" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb197-499"><a href="#cb197-499" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb197-500"><a href="#cb197-500" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb197-501"><a href="#cb197-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-502"><a href="#cb197-502" aria-hidden="true" tabindex="-1"></a><span class="co"># Get classification rules</span></span>
<span id="cb197-503"><a href="#cb197-503" aria-hidden="true" tabindex="-1"></a>rules <span class="ot">&lt;-</span> <span class="fu">disstree.get.rules</span>(tree, <span class="at">collapse =</span> <span class="st">"; "</span>)</span>
<span id="cb197-504"><a href="#cb197-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-505"><a href="#cb197-505" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of rules:"</span>, <span class="fu">length</span>(rules), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-506"><a href="#cb197-506" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Classification Rules:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-507"><a href="#cb197-507" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="dv">5</span>, <span class="fu">length</span>(rules))) {</span>
<span id="cb197-508"><a href="#cb197-508" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Rule %d:</span><span class="sc">\n</span><span class="st">"</span>, i))</span>
<span id="cb197-509"><a href="#cb197-509" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"  "</span>, rules[i], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-510"><a href="#cb197-510" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"  Interpretation: Sequences matching this rule belong to leaf"</span>, i, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-511"><a href="#cb197-511" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb197-512"><a href="#cb197-512" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb197-513"><a href="#cb197-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-514"><a href="#cb197-514" aria-hidden="true" tabindex="-1"></a><span class="fu">## Assign to Leaves (`disstree.assign`)</span></span>
<span id="cb197-515"><a href="#cb197-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-516"><a href="#cb197-516" aria-hidden="true" tabindex="-1"></a>**What it does**: Uses classification rules to assign new sequences (or existing ones) to leaf nodes based on their predictor values.</span>
<span id="cb197-517"><a href="#cb197-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-518"><a href="#cb197-518" aria-hidden="true" tabindex="-1"></a>**When to use**: When you want to classify new sequences or verify assignments.</span>
<span id="cb197-519"><a href="#cb197-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-520"><a href="#cb197-520" aria-hidden="true" tabindex="-1"></a>**Corresponds to Sequenzo**: <span class="in">`assign_to_leaves()`</span></span>
<span id="cb197-521"><a href="#cb197-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-524"><a href="#cb197-524" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb197-525"><a href="#cb197-525" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: assign-to-leaves</span></span>
<span id="cb197-526"><a href="#cb197-526" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb197-527"><a href="#cb197-527" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb197-528"><a href="#cb197-528" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb197-529"><a href="#cb197-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-530"><a href="#cb197-530" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign sequences to leaves using rules</span></span>
<span id="cb197-531"><a href="#cb197-531" aria-hidden="true" tabindex="-1"></a><span class="co"># This uses the same predictors we used to build the tree</span></span>
<span id="cb197-532"><a href="#cb197-532" aria-hidden="true" tabindex="-1"></a>assignments <span class="ot">&lt;-</span> <span class="fu">disstree.assign</span>(rules, predictors)</span>
<span id="cb197-533"><a href="#cb197-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-534"><a href="#cb197-534" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Assignments (first 10 sequences):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-535"><a href="#cb197-535" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(assignments[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>])</span>
<span id="cb197-536"><a href="#cb197-536" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Note: Each number corresponds to a rule/leaf node</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-537"><a href="#cb197-537" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"NA means the sequence doesn't match any rule</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-538"><a href="#cb197-538" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb197-539"><a href="#cb197-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-542"><a href="#cb197-542" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb197-543"><a href="#cb197-543" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: verify-assignments</span></span>
<span id="cb197-544"><a href="#cb197-544" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb197-545"><a href="#cb197-545" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb197-546"><a href="#cb197-546" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb197-547"><a href="#cb197-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-548"><a href="#cb197-548" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify that assignments match the tree's fitted values</span></span>
<span id="cb197-549"><a href="#cb197-549" aria-hidden="true" tabindex="-1"></a>tree_assignments <span class="ot">&lt;-</span> tree<span class="sc">$</span>fitted[, <span class="dv">1</span>]</span>
<span id="cb197-550"><a href="#cb197-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-551"><a href="#cb197-551" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Comparing assignments:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-552"><a href="#cb197-552" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"From tree:"</span>, tree_assignments[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-553"><a href="#cb197-553" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"From rules:"</span>, assignments[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-554"><a href="#cb197-554" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Match:"</span>, <span class="fu">all</span>(tree_assignments <span class="sc">==</span> assignments, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-555"><a href="#cb197-555" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb197-556"><a href="#cb197-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-557"><a href="#cb197-557" aria-hidden="true" tabindex="-1"></a><span class="fu"># Visualizing Trees</span></span>
<span id="cb197-558"><a href="#cb197-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-559"><a href="#cb197-559" aria-hidden="true" tabindex="-1"></a>Visualization is crucial for understanding tree structures! TraMineR provides several ways to visualize trees.</span>
<span id="cb197-560"><a href="#cb197-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-561"><a href="#cb197-561" aria-hidden="true" tabindex="-1"></a><span class="fu">## Print Tree (`print.disstree`)</span></span>
<span id="cb197-562"><a href="#cb197-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-563"><a href="#cb197-563" aria-hidden="true" tabindex="-1"></a>**What it does**: Prints a text-based representation of the tree in your console.</span>
<span id="cb197-564"><a href="#cb197-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-565"><a href="#cb197-565" aria-hidden="true" tabindex="-1"></a>**When to use**: Quick visualization, or when you want a simple text output.</span>
<span id="cb197-566"><a href="#cb197-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-567"><a href="#cb197-567" aria-hidden="true" tabindex="-1"></a>**Corresponds to Sequenzo**: <span class="in">`print_tree()`</span></span>
<span id="cb197-568"><a href="#cb197-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-571"><a href="#cb197-571" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb197-572"><a href="#cb197-572" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: print-tree</span></span>
<span id="cb197-573"><a href="#cb197-573" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb197-574"><a href="#cb197-574" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb197-575"><a href="#cb197-575" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb197-576"><a href="#cb197-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-577"><a href="#cb197-577" aria-hidden="true" tabindex="-1"></a><span class="co"># Print tree structure</span></span>
<span id="cb197-578"><a href="#cb197-578" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tree, <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">medoid =</span> <span class="cn">FALSE</span>)</span>
<span id="cb197-579"><a href="#cb197-579" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb197-580"><a href="#cb197-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-581"><a href="#cb197-581" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot Tree (`seqtreedisplay` / `disstreedisplay`)</span></span>
<span id="cb197-582"><a href="#cb197-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-583"><a href="#cb197-583" aria-hidden="true" tabindex="-1"></a>**What it does**: Creates a graphical visualization of the tree using GraphViz.</span>
<span id="cb197-584"><a href="#cb197-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-585"><a href="#cb197-585" aria-hidden="true" tabindex="-1"></a>**When to use**: When you want a visual representation for presentations or papers.</span>
<span id="cb197-586"><a href="#cb197-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-587"><a href="#cb197-587" aria-hidden="true" tabindex="-1"></a>**Note**: Requires GraphViz to be installed. For sequence trees, use <span class="in">`seqtreedisplay()`</span>. For distance trees, use <span class="in">`disstreedisplay()`</span>.</span>
<span id="cb197-588"><a href="#cb197-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-589"><a href="#cb197-589" aria-hidden="true" tabindex="-1"></a>**Corresponds to Sequenzo**: <span class="in">`plot_tree()`</span></span>
<span id="cb197-590"><a href="#cb197-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-593"><a href="#cb197-593" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb197-594"><a href="#cb197-594" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: plot-seqtree</span></span>
<span id="cb197-595"><a href="#cb197-595" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb197-596"><a href="#cb197-596" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb197-597"><a href="#cb197-597" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb197-598"><a href="#cb197-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-599"><a href="#cb197-599" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot sequence tree using seqtreedisplay</span></span>
<span id="cb197-600"><a href="#cb197-600" aria-hidden="true" tabindex="-1"></a><span class="co"># This creates a graphical visualization using GraphViz</span></span>
<span id="cb197-601"><a href="#cb197-601" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"[&gt;] Creating graphical visualization of sequence tree...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-602"><a href="#cb197-602" aria-hidden="true" tabindex="-1"></a><span class="fu">seqtreedisplay</span>(seqtree_result, <span class="at">filename =</span> <span class="cn">NULL</span>, <span class="at">show.tree =</span> <span class="cn">TRUE</span>)</span>
<span id="cb197-603"><a href="#cb197-603" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"‚úÖ Sequence tree visualization created!</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-604"><a href="#cb197-604" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb197-605"><a href="#cb197-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-608"><a href="#cb197-608" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb197-609"><a href="#cb197-609" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: plot-disstree</span></span>
<span id="cb197-610"><a href="#cb197-610" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb197-611"><a href="#cb197-611" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb197-612"><a href="#cb197-612" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb197-613"><a href="#cb197-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-614"><a href="#cb197-614" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot distance tree using disstreedisplay</span></span>
<span id="cb197-615"><a href="#cb197-615" aria-hidden="true" tabindex="-1"></a><span class="co"># This creates a graphical visualization using GraphViz</span></span>
<span id="cb197-616"><a href="#cb197-616" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"[&gt;] Creating graphical visualization of distance tree...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-617"><a href="#cb197-617" aria-hidden="true" tabindex="-1"></a><span class="fu">disstreedisplay</span>(tree, <span class="at">filename =</span> <span class="cn">NULL</span>, <span class="at">show.tree =</span> <span class="cn">TRUE</span>)</span>
<span id="cb197-618"><a href="#cb197-618" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"‚úÖ Distance tree visualization created!</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-619"><a href="#cb197-619" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb197-620"><a href="#cb197-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-621"><a href="#cb197-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-622"><a href="#cb197-622" aria-hidden="true" tabindex="-1"></a><span class="fu">## Export to DOT (`disstree2dot` / `seqtree2dot`)</span></span>
<span id="cb197-623"><a href="#cb197-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-624"><a href="#cb197-624" aria-hidden="true" tabindex="-1"></a>**What it does**: Exports the tree to GraphViz DOT format, which can be rendered as high-quality images.</span>
<span id="cb197-625"><a href="#cb197-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-626"><a href="#cb197-626" aria-hidden="true" tabindex="-1"></a>**When to use**: When you need publication-quality figures or want to customize the visualization.</span>
<span id="cb197-627"><a href="#cb197-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-628"><a href="#cb197-628" aria-hidden="true" tabindex="-1"></a>**Note**: Requires GraphViz to be installed. For sequence trees, use <span class="in">`seqtree2dot()`</span>. For distance trees, use <span class="in">`disstree2dot()`</span>.</span>
<span id="cb197-629"><a href="#cb197-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-630"><a href="#cb197-630" aria-hidden="true" tabindex="-1"></a>**Corresponds to Sequenzo**: <span class="in">`export_tree_to_dot()`</span></span>
<span id="cb197-631"><a href="#cb197-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-634"><a href="#cb197-634" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb197-635"><a href="#cb197-635" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: export-dot-seqtree</span></span>
<span id="cb197-636"><a href="#cb197-636" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb197-637"><a href="#cb197-637" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb197-638"><a href="#cb197-638" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb197-639"><a href="#cb197-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-640"><a href="#cb197-640" aria-hidden="true" tabindex="-1"></a><span class="co"># Export sequence tree to DOT format</span></span>
<span id="cb197-641"><a href="#cb197-641" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"[&gt;] Exporting sequence tree to DOT format...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-642"><a href="#cb197-642" aria-hidden="true" tabindex="-1"></a><span class="fu">seqtree2dot</span>(seqtree_result, <span class="at">filename =</span> <span class="st">"tree_analysis_lsog_seqtree"</span>, <span class="at">show.depth =</span> <span class="cn">FALSE</span>)</span>
<span id="cb197-643"><a href="#cb197-643" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"‚úÖ DOT file created: tree_analysis_lsog_seqtree.dot</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-644"><a href="#cb197-644" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"To render: dot -Tpng tree_analysis_lsog_seqtree.dot -o tree_analysis_lsog_seqtree.png</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-645"><a href="#cb197-645" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb197-646"><a href="#cb197-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-649"><a href="#cb197-649" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb197-650"><a href="#cb197-650" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: export-dot-disstree</span></span>
<span id="cb197-651"><a href="#cb197-651" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb197-652"><a href="#cb197-652" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb197-653"><a href="#cb197-653" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb197-654"><a href="#cb197-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-655"><a href="#cb197-655" aria-hidden="true" tabindex="-1"></a><span class="co"># Export distance tree to DOT format</span></span>
<span id="cb197-656"><a href="#cb197-656" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"[&gt;] Exporting distance tree to DOT format...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-657"><a href="#cb197-657" aria-hidden="true" tabindex="-1"></a><span class="fu">disstree2dot</span>(tree, <span class="at">filename =</span> <span class="st">"tree_analysis_lsog_disstree"</span>, <span class="at">show.depth =</span> <span class="cn">FALSE</span>)</span>
<span id="cb197-658"><a href="#cb197-658" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"‚úÖ DOT file created: tree_analysis_lsog_disstree.dot</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-659"><a href="#cb197-659" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"To render: dot -Tpng tree_analysis_lsog_disstree.dot -o tree_analysis_lsog_disstree.png</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-660"><a href="#cb197-660" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb197-661"><a href="#cb197-661" aria-hidden="true" tabindex="-1"></a>&lt;ÔΩútool‚ñÅcalls‚ñÅbeginÔΩú&gt;&lt;ÔΩútool‚ñÅcall‚ñÅbeginÔΩú&gt;</span>
<span id="cb197-662"><a href="#cb197-662" aria-hidden="true" tabindex="-1"></a>run_terminal_cmd</span>
<span id="cb197-663"><a href="#cb197-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-664"><a href="#cb197-664" aria-hidden="true" tabindex="-1"></a><span class="fu"># Complete Workflow Example</span></span>
<span id="cb197-665"><a href="#cb197-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-666"><a href="#cb197-666" aria-hidden="true" tabindex="-1"></a>Let's put it all together! Here's a complete example showing the typical workflow:</span>
<span id="cb197-667"><a href="#cb197-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-670"><a href="#cb197-670" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb197-671"><a href="#cb197-671" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: complete-workflow</span></span>
<span id="cb197-672"><a href="#cb197-672" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb197-673"><a href="#cb197-673" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb197-674"><a href="#cb197-674" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb197-675"><a href="#cb197-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-676"><a href="#cb197-676" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Load and prepare data</span></span>
<span id="cb197-677"><a href="#cb197-677" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the data_path defined earlier</span></span>
<span id="cb197-678"><a href="#cb197-678" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(data_path, </span>
<span id="cb197-679"><a href="#cb197-679" aria-hidden="true" tabindex="-1"></a>               <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>, <span class="at">check.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb197-680"><a href="#cb197-680" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df[<span class="dv">1</span><span class="sc">:</span><span class="dv">60</span>, ]</span>
<span id="cb197-681"><a href="#cb197-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-682"><a href="#cb197-682" aria-hidden="true" tabindex="-1"></a>time_cols <span class="ot">&lt;-</span> <span class="fu">names</span>(df)[<span class="fu">sapply</span>(<span class="fu">names</span>(df), <span class="cf">function</span>(x) {</span>
<span id="cb197-683"><a href="#cb197-683" aria-hidden="true" tabindex="-1"></a>    clean_x <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">"^X"</span>, <span class="st">""</span>, x)</span>
<span id="cb197-684"><a href="#cb197-684" aria-hidden="true" tabindex="-1"></a>    num_val <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">as.numeric</span>(clean_x))</span>
<span id="cb197-685"><a href="#cb197-685" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(num_val) <span class="sc">&amp;&amp;</span> clean_x <span class="sc">!=</span> <span class="st">""</span> <span class="sc">&amp;&amp;</span> x <span class="sc">!=</span> <span class="st">"dyadID"</span> <span class="sc">&amp;&amp;</span> x <span class="sc">!=</span> <span class="st">"sex"</span></span>
<span id="cb197-686"><a href="#cb197-686" aria-hidden="true" tabindex="-1"></a>})]</span>
<span id="cb197-687"><a href="#cb197-687" aria-hidden="true" tabindex="-1"></a>time_nums <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.numeric</span>(<span class="fu">sub</span>(<span class="st">"^X"</span>, <span class="st">""</span>, time_cols)))</span>
<span id="cb197-688"><a href="#cb197-688" aria-hidden="true" tabindex="-1"></a>time_cols <span class="ot">&lt;-</span> <span class="fu">as.character</span>(time_nums)</span>
<span id="cb197-689"><a href="#cb197-689" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">paste0</span>(<span class="st">"X"</span>, time_cols) <span class="sc">%in%</span> <span class="fu">names</span>(df))) {</span>
<span id="cb197-690"><a href="#cb197-690" aria-hidden="true" tabindex="-1"></a>    time_cols <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"X"</span>, time_cols)</span>
<span id="cb197-691"><a href="#cb197-691" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb197-692"><a href="#cb197-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-693"><a href="#cb197-693" aria-hidden="true" tabindex="-1"></a>seqdata <span class="ot">&lt;-</span> <span class="fu">seqdef</span>(df[, time_cols], <span class="at">alphabet =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, </span>
<span id="cb197-694"><a href="#cb197-694" aria-hidden="true" tabindex="-1"></a>                  <span class="at">states =</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"5"</span>, <span class="st">"6"</span>))</span>
<span id="cb197-695"><a href="#cb197-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-696"><a href="#cb197-696" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Create predictors</span></span>
<span id="cb197-697"><a href="#cb197-697" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb197-698"><a href="#cb197-698" aria-hidden="true" tabindex="-1"></a>predictors <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb197-699"><a href="#cb197-699" aria-hidden="true" tabindex="-1"></a>    <span class="at">gender =</span> <span class="fu">factor</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"M"</span>, <span class="st">"F"</span>), <span class="at">size =</span> <span class="fu">nrow</span>(df), <span class="at">replace =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb197-700"><a href="#cb197-700" aria-hidden="true" tabindex="-1"></a>    <span class="at">education =</span> <span class="fu">factor</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"low"</span>, <span class="st">"medium"</span>, <span class="st">"high"</span>), <span class="at">size =</span> <span class="fu">nrow</span>(df), <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb197-701"><a href="#cb197-701" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb197-702"><a href="#cb197-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-703"><a href="#cb197-703" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Build tree</span></span>
<span id="cb197-704"><a href="#cb197-704" aria-hidden="true" tabindex="-1"></a>tree <span class="ot">&lt;-</span> <span class="fu">seqtree</span>(seqdata <span class="sc">~</span> gender <span class="sc">+</span> education, <span class="at">data =</span> predictors,</span>
<span id="cb197-705"><a href="#cb197-705" aria-hidden="true" tabindex="-1"></a>                <span class="at">min.size =</span> <span class="fl">0.1</span>, <span class="at">max.depth =</span> <span class="dv">3</span>, <span class="at">R =</span> <span class="dv">100</span>, <span class="at">pval =</span> <span class="fl">0.1</span>)</span>
<span id="cb197-706"><a href="#cb197-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-707"><a href="#cb197-707" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Extract information</span></span>
<span id="cb197-708"><a href="#cb197-708" aria-hidden="true" tabindex="-1"></a>leaf_ids <span class="ot">&lt;-</span> <span class="fu">disstreeleaf</span>(tree)</span>
<span id="cb197-709"><a href="#cb197-709" aria-hidden="true" tabindex="-1"></a>rules <span class="ot">&lt;-</span> <span class="fu">disstree.get.rules</span>(tree)</span>
<span id="cb197-710"><a href="#cb197-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-711"><a href="#cb197-711" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Visualize</span></span>
<span id="cb197-712"><a href="#cb197-712" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tree)</span>
<span id="cb197-713"><a href="#cb197-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-714"><a href="#cb197-714" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">‚úÖ Complete workflow finished!</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-715"><a href="#cb197-715" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Tree has"</span>, <span class="fu">length</span>(<span class="fu">unique</span>(leaf_ids)), <span class="st">"leaf nodes</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-716"><a href="#cb197-716" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Found"</span>, <span class="fu">length</span>(rules), <span class="st">"classification rules</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb197-717"><a href="#cb197-717" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb197-718"><a href="#cb197-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-719"><a href="#cb197-719" aria-hidden="true" tabindex="-1"></a><span class="fu"># Summary and Next Steps</span></span>
<span id="cb197-720"><a href="#cb197-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-721"><a href="#cb197-721" aria-hidden="true" tabindex="-1"></a>Congratulations! üéâ You've learned how to use TraMineR to:</span>
<span id="cb197-722"><a href="#cb197-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-723"><a href="#cb197-723" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>‚úÖ Compute pseudo-variance to measure sequence diversity (<span class="in">`dissvar`</span>)</span>
<span id="cb197-724"><a href="#cb197-724" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>‚úÖ Test associations between groups and sequence patterns (<span class="in">`dissassoc`</span>)</span>
<span id="cb197-725"><a href="#cb197-725" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>‚úÖ Build regression trees from distance matrices and sequence data (<span class="in">`disstree`</span>, <span class="in">`seqtree`</span>)</span>
<span id="cb197-726"><a href="#cb197-726" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>‚úÖ Extract leaf memberships and classification rules (<span class="in">`disstreeleaf`</span>, <span class="in">`disstree.get.rules`</span>)</span>
<span id="cb197-727"><a href="#cb197-727" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>‚úÖ Visualize trees using text and plots (<span class="in">`print`</span>, <span class="in">`plot`</span>)</span>
<span id="cb197-728"><a href="#cb197-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-729"><a href="#cb197-729" aria-hidden="true" tabindex="-1"></a><span class="fu">## Key Takeaways</span></span>
<span id="cb197-730"><a href="#cb197-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-731"><a href="#cb197-731" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Pseudo-variance** (<span class="in">`dissvar`</span>) tells you how diverse your sequences are</span>
<span id="cb197-732"><a href="#cb197-732" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Association tests** (<span class="in">`dissassoc`</span>) tell you if groups differ significantly</span>
<span id="cb197-733"><a href="#cb197-733" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Trees** (<span class="in">`disstree`</span>, <span class="in">`seqtree`</span>) automatically find which factors explain sequence differences</span>
<span id="cb197-734"><a href="#cb197-734" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Rules** (<span class="in">`disstree.get.rules`</span>) help you understand and explain tree structures</span>
<span id="cb197-735"><a href="#cb197-735" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Visualization** (<span class="in">`print`</span>, <span class="in">`plot`</span>) makes trees easy to understand and present</span>
<span id="cb197-736"><a href="#cb197-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-737"><a href="#cb197-737" aria-hidden="true" tabindex="-1"></a><span class="fu">## What's Next?</span></span>
<span id="cb197-738"><a href="#cb197-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-739"><a href="#cb197-739" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Try different distance measures (OM, HAM, DHD)</span>
<span id="cb197-740"><a href="#cb197-740" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Experiment with different predictor variables</span>
<span id="cb197-741"><a href="#cb197-741" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Adjust tree parameters (min.size, max.depth, pval)</span>
<span id="cb197-742"><a href="#cb197-742" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Compare results with Sequenzo Python implementation</span>
<span id="cb197-743"><a href="#cb197-743" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Explore other TraMineR modules!</span>
<span id="cb197-744"><a href="#cb197-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-745"><a href="#cb197-745" aria-hidden="true" tabindex="-1"></a><span class="fu">## Further Reading</span></span>
<span id="cb197-746"><a href="#cb197-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-747"><a href="#cb197-747" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>TraMineR documentation: https://traminer.unige.ch/</span>
<span id="cb197-748"><a href="#cb197-748" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Studer et al. (2011): Discrepancy analysis of state sequences</span>
<span id="cb197-749"><a href="#cb197-749" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>TraMineR User's Guide: Available in R with <span class="in">`vignette("TraMineR")`</span></span>
<span id="cb197-750"><a href="#cb197-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-751"><a href="#cb197-751" aria-hidden="true" tabindex="-1"></a>Happy analyzing! üå≥‚ú®</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>